---
title: "Figures"
author: "Alex Benecke"
date: "August 6, 2018"
output:
  html_document:
    df_print: paged
    fig_height: 6
    fig_width: 8
    toc: yes
    toc_depth: 4
    toc_float: yes
  word_document:
    reference_docx: word-styles_Figures.docx
    toc: yes
    toc_depth: '4'
editor_options:
  chunk_output_type: console
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, eval = FALSE, message = FALSE, results = "asis")
```


```{r Load Packages, eval=TRUE, include=FALSE}
### Load Packages
library(FSA)
library(tidyverse)
library(dplyr)
library(magrittr)
library(scales)
library(mgcv)
library(sciplot)
library(knitr)
library(kableExtra)
library(pipeR)

#source("plot_centered_mean.R")

source("5_functions/dropbox_fn.R") # For interacting with dropbox
proj = "shark" # Specify project where data is stored 

source("5_functions/model_selection_fn.R")

source("5_functions/load_data.R")
```

```{r Load Data, eval=TRUE, echo=FALSE, include=FALSE}
### Blacknose
blacknose <- read_csv_fn( "data/clean-data/blacknose.csv", proj) %>%
  mutate(YEAR = factor(YEAR), 
         MONTH = factor(strftime(DATE, format = "%b")))

### Blacktip
blacktip <- read_csv_fn( "data/clean-data/blacktip.csv", proj) %>%
  mutate(YEAR = factor(YEAR), 
         MONTH = factor(strftime(DATE, format = "%b")))

### Bull
bull <- read_csv_fn( "data/clean-data/bull.csv", proj) %>%
  mutate(YEAR = factor(YEAR), 
         MONTH = factor(strftime(DATE, format = "%b")))

### Sandbar
sandbar <- read_csv_fn( "data/clean-data/sandbar.csv", proj) %>%
  mutate(YEAR = factor(YEAR), 
         MONTH = factor(strftime(DATE, format = "%b")))

### Sharpnose
sharpnose <- read_csv_fn( "data/clean-data/sharpnose.csv", proj) %>%
  mutate(YEAR = factor(YEAR), 
         MONTH = factor(strftime(DATE, format = "%b")))

### Silky
silky <- read_csv_fn( "data/clean-data/silky.csv", proj) %>%
  mutate(YEAR = factor(YEAR), 
         MONTH = factor(strftime(DATE, format = "%b")))

### Spinner
spinner <- read_csv_fn( "data/clean-data/spinner.csv", proj) %>%
  mutate(YEAR = factor(YEAR), 
         MONTH = factor(strftime(DATE, format = "%b")))

### Tiger
tiger <- read_csv_fn( "data/clean-data/tiger.csv", proj) %>%
  mutate(YEAR = factor(YEAR), 
         MONTH = factor(strftime(DATE, format = "%b")))

### Strata 1 list
strat1 <- list(blacknose = blacknose,
              blacktip = blacktip,
              bull = bull,
              sandbar = sandbar,
              sharpnose = sharpnose,
              silky = silky,
              spinner = spinner,
              tiger = tiger)


### Strata 2 List


strat2 <- list(blacknose = blacknose %>% subset(pres == 1),
              blacktip = blacktip %>% subset(pres == 1),
              bull = bull %>% subset(pres == 1),
              sandbar = sandbar %>% subset(pres == 1),
              sharpnose = sharpnose %>% subset(pres == 1),
              silky = silky %>% subset(pres == 1),
              spinner = spinner %>% subset(pres == 1),
              tiger = tiger %>% subset(pres == 1))




### Strata 2 List


zero <- list(blacknose = blacknose %>% subset(pres == 0),
              blacktip = blacktip %>% subset(pres == 0),
              bull = bull %>% subset(pres == 0),
              sandbar = sandbar %>% subset(pres == 0),
              sharpnose = sharpnose %>% subset(pres == 0),
              silky = silky %>% subset(pres == 0),
              spinner = spinner %>% subset(pres == 0),
              tiger = tiger %>% subset(pres == 0))

####################

eff3 <- read_csv_fn( "data/clean-data/CPUE3.csv", proj)

eff3$count <- 1

str(eff3)
headtail(eff3)

strat1_Adult <- load_data(data = eff3[eff3$maturity == "A",], strata = 1)
strat2_Adult <- load_data(data = eff3[eff3$maturity == "A",], strata = 2)

strat1_Juvenile <- load_data(data = eff3[eff3$maturity == "J",], strata = 1)
strat2_Juvenile <- load_data(data = eff3[eff3$maturity == "J",], strata = 2)
```

```{r Remove Data, eval=FALSE, include=FALSE}
rm(blacknose, blacktip, bull, sandbar, sharpnose, silky, spinner, tiger)
```

```{r Load Model Fits, eval=TRUE, include=FALSE}
### Strata1
load( file = "output/output_GAM/best_strat1/bn1_best.rda" )
load( file = "output/output_GAM/best_strat1/bt1_best.rda" )
load( file = "output/output_GAM/best_strat1/bu1_best.rda" )
load( file = "output/output_GAM/best_strat1/sb1_best.rda" )
load( file = "output/output_GAM/best_strat1/sn1_best.rda" )
load( file = "output/output_GAM/best_strat1/si1_best.rda" )
load( file = "output/output_GAM/best_strat1/sp1_best.rda" )
load( file = "output/output_GAM/best_strat1/ti1_best.rda" )

s1 <- list(bn1_best = bn1_best
,
           bt1_best = bt1_best
,
           bu1_best = bu1_best
,
           sb1_best = sb1_best
,
           sn1_best = sn1_best
,
           si1_best = si1_best
,
           sp1_best = sp1_best
,
           ti1_best = ti1_best
)




### Fit time strat 1
load(file = "output/output_GAM/strat1/time_fit_strat_1.rda")



### Strata 2
load( file = "output/output_GAM/best_strat2/bn_best.rda" )
load( file = "output/output_GAM/best_strat2/bt_best.rda" )
load( file = "output/output_GAM/best_strat2/bu_best.rda" )
load( file = "output/output_GAM/best_strat2/sb_best.rda" )
load( file = "output/output_GAM/best_strat2/sn_best.rda" )
load( file = "output/output_GAM/best_strat2/si_best.rda" )
load( file = "output/output_GAM/best_strat2/sp_best.rda" )
load( file = "output/output_GAM/best_strat2/ti_best.rda" )

s2 <- list(bn_best = bn_best
,
           bt_best = bt_best
,
           bu_best = bu_best
,
           sb_best = sb_best
,
           sn_best = sn_best
,
           si_best = si_best
,
           sp_best = sp_best
,
           ti_best = ti_best
)

### Fit time strat 2
load(file = "output/output_GAM/strat2/time_fit_strat_2.rda")


```

```{r remove models, eval=TRUE}
rm(bn_best, bt_best, bu_best, sb_best, sn_best, si_best, sp_best, ti_best, 
   bn1_best, bt1_best, bu1_best, sb1_best, sn1_best, si1_best, sp1_best, ti1_best)
```



# List of Tables and Figures

## List of Tables

1. summarize presence occurance (PA) and abundance (PRES)  of data used in analysis
i. give number of zeros and number of data pointa for both strata (PA and PRES) and level MATURE IMATURE (MALE and FEMALE) and Species
ii. Describe size cutoffs for Mature and Immature in captions
iii. either by year or by grouping years?
iv. Overall $\%$ of bottom long-line sets where a species of shark was present

2. List of variables and a description of each
i. units
ii. type Biotic? environmental
iii. Temporal or spacial...

3. Model Selection
i. Say top 2 or 3 models and global model for each species strata and level Mature immature (Male Female)
ii. identify model (stage strata lavel M I M F...)
iii. order best to worst + global model (A, B ... Global) 
iv. Model structure
v. Dev($\%$)
vi. AIC (or BIC)


## List of Figures

1. Site Map of northern Gulf of Mexico
i. give depth contours
ii. regions?

2. Smooth Fits for each variable by strata and maturity (Maybe Sex)
i. display in table of plots Explanatory variables x and strata maturity (and Sex) on Y

3. Heat Map showing CPUE by area in nGoM
i. maybe show map with presence and abscense of each species aswell 
ii. either species 4 rows by 2 columns Or consider year to year comparison of each species


## Tables ##

### Table 1

This should be a barplot

summarize presence occurance (PA) and abundance (PRES)  of data used in analysis

i. give number of zeros and number of data pointa for both strata (PA and PRES) and level MATURE IMATURE (MALE and FEMALE) and Species
ii. Describe size cutoffs for Mature and Immature in captions
iii. either by year or by grouping years?
iv. Overall $\%$ of bottom long-line sets where a species of shark was present

```{r Prepare table 1, eval=TRUE}
Species <- c( "Blacknose", "Blacktip", "Bull", "Sandbar", 
                  "Sharpnose", "Silky", "Spinner", "Tiger")

for(i in 1:length(strat1)){
  
  strat1[[i]]$Species <- rep(Species[i], nrow(strat1[[i]]))
  
}

all.df <- rbind(strat1[[1]], strat1[[2]], strat1[[3]],strat1[[4]],
                 strat1[[5]], strat1[[6]], strat1[[7]], strat1[[8]]) %>%
  select("Species", "YEAR", "pres")

for(i in 1:nrow(all.df)){
  
  if(all.df$pres[i] == 0){
    
    all.df$absent[i] <- 1
    
  }else {
    
    all.df$absent[i] <- 0
    
  }
  
}


all.df$tot <- all.df$pres + all.df$absent

pres.df <- aggregate(pres ~ YEAR + Species, data = all.df, FUN = sum)

zero.df <- aggregate(absent ~ YEAR + Species, data = all.df, FUN = sum)

tot.df <- aggregate(tot ~ YEAR + Species, data = all.df, FUN = sum)

tot.df$percent_pres <- round((pres.df$pres/tot.df$tot)*100, 2)

table1 <- left_join(tot.df, pres.df, by = c("Species", "YEAR")) %>%
  left_join(zero.df, by = c("Species", "YEAR")) %>%
  select(Species, YEAR, pres, absent, tot, percent_pres) %>%
  rename(Year = YEAR, Presence = pres, Absent = absent, "Percent Present" = percent_pres) 


head(table1)


#for(i in 1:length(Species)){
#  
#  assign(paste0("row_sp_", i),
#         range(which(table1$Species == Species[i]))
#)
#  
#}
#row_sp_1
#
#row_sp_7
```



```{r Table 1, eval=TRUE}

table1 %>%
  kable() %>%
  kable_styling(full_width = F, position = "center", font_size = 10) %>%
  collapse_rows(1:2, valign = "top")
  
  
  #group_rows(Species[1],row_sp_1[1], row_sp_1[2]) %>%
  #group_rows(Species[2],row_sp_2[1], row_sp_2[2]) %>%
  #group_rows(Species[3],row_sp_3[1], row_sp_3[2]) %>%
  #group_rows(Species[4],row_sp_4[1], row_sp_4[2]) %>%
  #group_rows(Species[5],row_sp_5[1], row_sp_5[2]) %>%
  #group_rows(Species[6],row_sp_6[1], row_sp_6[2]) %>%
  #group_rows(Species[7],row_sp_7[1], row_sp_7[2]) %>%
  #group_rows(Species[8],row_sp_8[1], row_sp_8[2])
  
  
  #collapse_rows(columns = 1:2, valign = "middle")


```

### Alt Table 1 a (n Pos catch stations)

#### Table of Positive catch sites per year
```{r Make Data frame for numver of sites with positive catch each year, results = 'hide', eval=TRUE, include=FALSE}
Species <- levels(eff3$common)

for(i in 1:length( levels( eff3$common ) ) ){
  
 ## Female Adult
  aggregate(pres ~ year, data =strat1_Adult$Female[[i]], FUN = sum, drop = FALSE)[,"pres"] %>%
    t() %>%
    data.frame() %>%
    mutate( Species = Species[i], Sex = "Female", Maturity = "Adult") %>>%
    (~tmp_FA)
  
  colnames(tmp_FA) <- c(seq(2001,2017,1), "Species", "Sex", "Maturity")


 ## Female Juvenile
  aggregate(pres ~ year, data =strat1_Juvenile$Female[[i]], FUN = sum, drop = FALSE)[,"pres"] %>%
    t() %>%
    data.frame() %>%
    mutate( Species = Species[i], Sex = "Female", Maturity = "Juvenile") %>>%
    (~tmp_FJ)
  
  colnames(tmp_FJ) <- c(seq(2001,2017,1), "Species", "Sex", "Maturity")


 ## Male Adult
  aggregate(pres ~ year, data =strat1_Adult$Male[[i]], FUN = sum, drop = FALSE)[,"pres"] %>%
    t() %>%
    data.frame() %>%
    mutate( Species = Species[i], Sex = "Male", Maturity = "Adult")  %>>%
    (~tmp_MA)
  
  colnames(tmp_MA) <- c(seq(2001,2017,1), "Species", "Sex", "Maturity")


 ## Male Juvenile
  aggregate(pres ~ year, data =strat1_Juvenile$Male[[i]], FUN = sum, drop = FALSE)[,"pres"] %>%
    t() %>%
    data.frame() %>%
    mutate( Species = Species[i], Sex = "Male", Maturity = "Juvenile") %>>%
    (~tmp_MJ)
  
  colnames(tmp_MJ) <- c(seq(2001,2017,1), "Species", "Sex", "Maturity")

if(i == 1){
  
  rbind(tmp_FA, tmp_FJ, tmp_MA, tmp_MJ) %>>%
    (~tmp.df)  
  
} else{
  
  rbind(tmp.df, tmp_FA, tmp_FJ, tmp_MA, tmp_MJ) %>>%
    (~tmp.df)
  
}

}



pres.tbl <- tmp.df %>%
  select(Species, Sex, Maturity, "2001":"2017")
pres.tbl



pres.tbl$Total <- apply(pres.tbl[,4:20], 1, FUN = sum)
pres.tbl



pres.tbl

```

```{r prep total sites row of pos catch table, results = 'hide', eval=TRUE, include=FALSE}

### Get total number of sites sampled each year
aggregate(count ~ year, data =strat1_Adult$Female[[i]], FUN = sum, drop = FALSE)[,"count"] %>%
    t() %>%
    data.frame() %>%
    mutate( Species = "Total Stations", Sex = "", Maturity = "") %>>%
    (~all.sites.yr.sum)
  
  colnames(all.sites.yr.sum) <- c(seq(2001,2017,1), "Species", "Sex", "Maturity")

all.sites.yr.sum %<>%
  select(Species, Sex, Maturity, "2001":"2017")

all.sites.yr.sum

all.sites.yr.sum$Total <- apply(all.sites.yr.sum[,c(4:20)], 1, FUN = sum)

all.sites.yr.sum

all.sites.yr.sum


pres.tbl <- rbind(pres.tbl, all.sites.yr.sum)
pres.tbl

#8-20-2018#write_csv_fn(pres.tbl, file = "data/clean-data/table-data/pres_tbl.csv", proj = proj)

```

```{r Make table of positive catch sites per year, eval=TRUE, include=TRUE}
pres.tbl %>%
  kable() %>%
  kable_styling(full_width = F, 
                position = "center", 
                font_size = 10,
                bootstrap_options = "striped") %>%
  column_spec(1, bold = T, background = "White") %>%
  column_spec(2, background = "White") %>%
  column_spec(21, border_left = T) %>%
  collapse_rows(c(1:3), valign = "middle")
```


### Alt Table 1 b (Percent of Stations with Pos Catch)

```{r Prep Percent pos catch table, results='hide', eval=TRUE, include=FALSE}
all.sites.yr.sum <- pres.tbl[29,-c(22:23)]
row.names(all.sites.yr.sum) <- c(1)         

all.sites.yr.sum


tmp <- pres.tbl[c(1:28),-c(22:23)]
tmp


for(i in 1:nrow(tmp)){
  
  tmp[i,c(4:21)] <- round((tmp[i,c(4:21)]/all.sites.yr.sum[1,c(4:21)])*100, 1)
  
}


tmp

percent.pres.tbl <- tmp


percent.pres.tbl

#8-20-2018#write_csv_fn(percent.pres.tbl, file = "data/clean-data/table-data/percent_pres_tbl.csv", proj = proj)


```

```{r Make table of Percent positive of each species by year, eval=TRUE, include=TRUE}
percent.pres.tbl %>%
  kable() %>%
  kable_styling(full_width = F, 
                position = "center", 
                font_size = 10,
                bootstrap_options = "striped") %>%
  column_spec(1, bold = T, background = "White") %>%
  column_spec(2, background = "White") %>%
  column_spec(21, border_left = T) %>%
  collapse_rows(c(1:3), valign = "middle")
```

### Table 2

*List of variables and a description of each*

i. units
ii. type Biotic? environmental
iii. Temporal or spacial...

```{r, results='hide', eval=TRUE, include=FALSE}
head(strat1_Adult$Male$sharpnose)

var.tbl <- eff3 %>%
  select(year, startlat, startlon, startdepth, tempbotm, fluorobotm, turbbotm, oxybotm, salbotm, Dis.to.SHORE, CPUE, Adj.CPUE)

head(var.tbl)

length(var.tbl)



Min <- round(apply(var.tbl, 2, FUN =  min, na.rm = T),0)
Max <- round(apply(var.tbl, 2, FUN =  max, na.rm = T),0)
Mean <- round(apply(var.tbl, 2, FUN =  mean, na.rm = T),0)
SD <- round(apply(var.tbl, 2, FUN =  sd, na.rm = T),0)

var.tbl.2 <- rbind(Min, Max, Mean, SD) %>% t() %>% data.frame()

var.tbl.2
```


```{r, eval=TRUE, include=TRUE}
var.tbl.2 %>%
  kable() %>%
  kable_styling(full_width = F, 
                position = "center", 
                font_size = 10,
                bootstrap_options = "striped") 
```


### Table 3 Model Selecton

Model Selection

i. Say top 2 or 3 models and global model for each species strata and level Mature immature (Male Female)
ii. identify model (stage strata lavel M I M F...)
iii. order best to worst + global model (A, B ... Global) 
iv. Model structure
v. Dev($\%$)
vi. AIC (or BIC)


#### Strata 1 Table 3

```{r Set up Table 3, eval=TRUE}
Species <- c( "Blacknose", "Blacktip", "Bull", "Sandbar", 
                  "Sharpnose", "Silky", "Spinner", "Tiger") %>%
  factor()

Strata = c("Presence", "Abundance") %>%
  factor()

Maturity = c("Mixed", "Immature") %>%
  factor()  

Mod_levs <- c("s1M", "s1I", "s2M", "s2I")

for(i in 1:length(Mod_levs)){
  
  assign(paste0("Optimal_Model_", Mod_levs[i]),
         numeric(8))
  
  assign(paste0("Dev_", Mod_levs[i]),
         numeric(8))
  
  assign(paste0("AIC_", Mod_levs[i]),
         numeric(8))     
  
}


for(i in 1:length(s1)){
  
  ### S1 Mature
  Optimal_Model_s1M[i] <- paste(c("Pres", paste( rownames(summary(s1[[i]])$s.table), collapse = " + ")),
                               collapse = " ~ ")
  Dev_s1M[i] <- summary(s2[[i]])$dev.expl *100
  AIC_s1M[i] <- s2[[i]]$aic
  
  ### S1 Immature
  Optimal_Model_s1I[i] <- NA
  Dev_s1I[i] <- NA
  AIC_s1I[i] <- NA
                       
  
  ### S2 Mature
  Optimal_Model_s2M[i] <- paste(c("(CPUE +1)", paste( rownames(summary(s2[[i]])$s.table), collapse = " + ")),
                               collapse = " ~ ")
  Dev_s2M[i] <- summary(s2[[i]])$dev.expl *100
  AIC_s2M[i] <- s2[[i]]$aic
  
  ### S2 Immature
  Optimal_Model_s2I[i] <- NA
  Dev_s2I[i] <- NA
  AIC_s2I[i] <- NA 
  
  }

### Strata 1
tmp.s1M <- data.frame(Species = Species,
                     Strata = Strata[1],
                     Maturity = Maturity[1], 
                     Optimal_Model = Optimal_Model_s1M,
                     Dev = Dev_s1M,
                     AIC = AIC_s1M)
tmp.s1I <- data.frame(Species = Species,
                     Strata = Strata[1],
                     Maturity = Maturity[2], 
                     Optimal_Model = Optimal_Model_s1I,
                     Dev = Dev_s1I,
                     AIC = AIC_s1I)

### Strata 2 
tmp.s2M <- data.frame(Species = Species,
                     Strata = Strata[2],
                     Maturity = Maturity[1], 
                     Optimal_Model = Optimal_Model_s2M,
                     Dev = Dev_s2M,
                     AIC = AIC_s2M)
tmp.s2I <- data.frame(Species = Species,
                     Strata = Strata[2],
                     Maturity = Maturity[2], 
                     Optimal_Model = Optimal_Model_s2I,
                     Dev = Dev_s2I,
                     AIC = AIC_s2I)

### Table 2 data frame
table3 <- rbind(tmp.s1M, tmp.s1I,
                tmp.s2M, tmp.s2I) %>%
  arrange(Species)

table3$Dev <- round(table3$Dev, 1)
table3$AIC <- round(table3$AIC, 1)
```




```{r Table 3, eval=TRUE, include=TRUE}
table3 %>%
  kable() %>%
  kable_styling(font_size = 10) %>%
  collapse_rows(columns = 1:3, valign = "middle")
```


### Table 4 GAM Results

i. identify model (stage strata lavel M I M F...)
ii. list variables
iii. Range (rank)
iv. EDF
v. Trend (e.g., down, up (peak 2007), down...)
vi. consider seperate table for each strata and/or species maybe even model IDK see how this looks.



I think Table 3 covers this pretty well

```{r}

```


## Figures ##


### Figure 1 Site Map of northern Gulf of Mexico

Meg says to scrap this. 
  Use dots to represent stations and size (or transparensy) to represent number of stations
  make land dark grey and include state lines
  make water lighter grey no depth contours
  
#### New Figure 1
```{r}
my_xlim <- c( -97, -81.5) #c(-97.5, -81)

my_ylim <- c( 24.5, 30.5 )

x_ticks <- seq( -97, -81.5 )
#-80.75, -81.25
y_ticks <- round( seq( 24.5, 30.5, length.out = 5 ), 1 )


cex_pts <- 0.425
col_pts <- rgb( 0.25, 0.25, 0.25, 0.25 ) ### only for Strata 1
cex_legend <- 1.25

lwd_axis <- 1.25
cex_axis <- 1.25
cex_mtxt <- 1.5

Lon_line <- 2
Lat_line <- 2.75
```
```{r}
require(maptools)
require(sp)
library(rgdal)
library(lubridate)

gulf.shape <- "shape-file\\Shape\\stateshigh.shp"
gulf.shape <- maptools::readShapePoly(gulf.shape)
```
```{r study area line, eval = TRUE}
study_area <- read.csv(file = "study_area.csv")
study_area2 <- read.csv(file = "study_area2.csv")
```

```{r tiff for new figure 1}
tiff(filename = "6_figures\\figures\\Figure_1.tiff", width = 4000,  height = 2000, res = 300)
```

```{r New Figure 1}
par(oma = c(2.75, 3.5, 0, 0), # two rows of text at the outer left and bottom margin
    mar = c(0.5, 0.5, 0, 0), # space for one row of text at ticks and to separate plots
    mgp = c(2, 0.75, 0))

plot(study_area$x,study_area$y,
         xlim = c( -97, -81.5),
         ylim = my_ylim,
         xlab = "", ylab = "",
         xaxt = "n", yaxt = "n",
     type = "n",
     bty = "n")

rect(par("usr")[1], par("usr")[3], par("usr")[2], par("usr")[4], col = "gray98")

sp::plot(gulf.shape, add = T,
         xlim = c( -97, -81.5),
         ylim = my_ylim,
         xlab = "", ylab = "",
         xaxt = "n", yaxt = "n",
         col = "gray",
         bty="n")

polygon(c(study_area$x,study_area2$x),  c(study_area$y, study_area2$y), density = 5, angle = 135, border = rgb(1,1,1,0), lty = 3, lwd = 1.25)
polygon(c(study_area$x,study_area2$x),  c(study_area$y, study_area2$y), density = 5, angle = 45, border = rgb(1,1,1,0), lty = 3, lwd = 1.25)


axis(2,
     at = y_ticks,
     las = 2,
     lwd = lwd_axis,
     cex.axis = cex_axis)

mtext("Latitude",
      side = 2,
      line = Lat_line,
      cex = cex_mtxt)

axis(1,
     at = x_ticks,
     lwd = lwd_axis,
     cex.axis = cex_axis)

mtext("Longitude",
      side = 1,
      line = Lon_line,
      cex = cex_mtxt)


#dev.off()

```



#### Old Figure 1

i. give depth contours
ii. regions?

```{r Load shapefiles for Figure 1, eval = TRUE}
require(maptools)
require(sp)
library(rgdal)
library(lubridate)


gulf.shape <- "shape-file\\Shape\\stateshigh.shp"
gulf.shape <- maptools::readShapePoly(gulf.shape)

gulf.bath1 <- "shape-file\\bath\\ne_10m_bathymetry_all\\ne_10m_bathymetry_L_0.shp"
gulf.bath2 <- "shape-file\\bath\\ne_10m_bathymetry_all\\ne_10m_bathymetry_K_200.shp"
gulf.bath3 <- "shape-file\\bath\\ne_10m_bathymetry_all\\ne_10m_bathymetry_J_1000.shp"
gulf.bath4 <- "shape-file\\bath\\ne_10m_bathymetry_all\\ne_10m_bathymetry_I_2000.shp"
gulf.bath5 <- "shape-file\\bath\\ne_10m_bathymetry_all\\ne_10m_bathymetry_H_3000.shp"
gulf.bath6 <- "shape-file\\bath\\ne_10m_bathymetry_all\\ne_10m_bathymetry_G_4000.shp"
gulf.bath7 <- "shape-file\\bath\\ne_10m_bathymetry_all\\ne_10m_bathymetry_F_5000.shp"
gulf.bath8 <- "shape-file\\bath\\ne_10m_bathymetry_all\\ne_10m_bathymetry_E_6000.shp"
gulf.bath9 <- "shape-file\\bath\\ne_10m_bathymetry_all\\ne_10m_bathymetry_D_7000.shp"
gulf.bath10 <- "shape-file\\bath\\ne_10m_bathymetry_all\\ne_10m_bathymetry_C_8000.shp"
gulf.bath11 <- "shape-file\\bath\\ne_10m_bathymetry_all\\ne_10m_bathymetry_B_9000.shp"
gulf.bath12 <- "shape-file\\bath\\ne_10m_bathymetry_all\\ne_10m_bathymetry_A_10000.shp"

country <- "shape-file\\countries\\ne_10m_admin_0_countries\\ne_10m_admin_0_countries.shp"
country <- maptools::readShapePoly(country)


gulf.bath <- list(gulf.bath1 = gulf.bath1,
                  gulf.bath2 = gulf.bath2,
                  gulf.bath3 = gulf.bath3,
                  gulf.bath4 = gulf.bath4,
                  gulf.bath5 = gulf.bath5,
                  gulf.bath6 = gulf.bath6,
                  gulf.bath7 = gulf.bath7,
                  gulf.bath8 = gulf.bath8,
                  gulf.bath9 = gulf.bath9,
                  gulf.bath10 = gulf.bath10,
                  gulf.bath11 = gulf.bath11,
                  gulf.bath12 = gulf.bath12)

for(i in 1:length(gulf.bath)){
  
  gulf.bath[[i]] <- maptools::readShapePoly(gulf.bath[[i]])
  
}
```

```{r Figure 1 Prep, eval = TRUE}
#x1 <- c(-98.72202, 79.78476)
#y1 <- c( 19.54442, 31.43526)
y_ticks <- round(seq(24.5, 30.5, length.out = 5),1)
###### ^ Old ^ #####

my_xlim <- c(-97.5, -81)
my_ylim <- c(24.5,30.5)

x_ticks <- seq(-98, -81)
(y1_ticks <-  round(seq(20, 30.5, length.out = 5),1))
#(x1_ticks <- seq(-98.72202, -79.78476, length.out = 5))


lwd_axis1 <- 1
cex_axis1 <- 1
cex_mtxt1 <- 1.5

Lon_line1 <- 2
Lat_line1 <- 2.5

require(magrittr)
#seq(40, 84,6)
#(j = seq(40, 84, 4) %>% sort( decreasing = TRUE))

#(j = seq(22, 90, 6) %>% sort( decreasing = TRUE))

(j = seq(16, 93, 7) %>% sort( decreasing = TRUE))

#(j = seq(8, 96, 8) %>% sort( decreasing = TRUE))

(j = seq(0, 88, 8) %>% sort( decreasing = TRUE))

my_col <- numeric(length(j))


for(i in 1:length(j)){
  
  my_col[i] <- paste0("grey", j[i])
  
}

my_col

```

```{r study area line, eval = TRUE}
study_area <- read.csv(file = "study_area.csv")
study_area2 <- read.csv(file = "study_area2.csv")
```

```{r tiff Figure 1}
tiff(filename = "6_figures\\figures\\Figure_1.tiff", width = 4000,  height = 2000, res = 300)
```

```{r Plotting Figure 1, eval = TRUE}
par(oma = c(2.75, 3.5, 0, 0), # two rows of text at the outer left and bottom margin
    mar = c(0.5, 0.5, 0, 0), # space for one row of text at ticks and to separate plots
    mgp = c(2, 0.75, 0))    # axis label at 2 rows distance, tick labels at 1 row

sp::plot(country,
         ylim = c(24.5,29.5),
         xlim = c(-98, -81),
         bty="n",
         col = "WHITE")#,
         #density = 10,
         #angle = 45)



#lines(x = study_area$x, y = study_area$y)
#lines(x = study_area2$x, y = study_area2$y)
#polygon(c(study_area$x,study_area2$x),  c(study_area$y, study_area2$y), density = 10, angle = 45)
#polygon(c(study_area$x,study_area2$x),  c(study_area$y, study_area2$y), density = 10, angle = 135)

    axis(2,
     at = y_ticks,
     las = 2,
     lwd = lwd_axis1,
     cex.axis = cex_axis1)
  
    mtext("Latitude",
      side = 2,
      line = Lat_line1,
      cex = cex_mtxt1)
    
    
    axis(1,
     at = x_ticks,
     lwd = lwd_axis1,
     cex.axis = cex_axis1)
  
    mtext("Longitude",
      side = 1,
      line = Lon_line1,
      cex = cex_mtxt1) 
    
    #dev.off()

for(i in 1:6){#length(gulf.bath)){
  
    sp::plot(gulf.bath[[i]], add =T,
           xlab = "", ylab = "",
           yaxt = "n", xaxt = "n",
         xlim = my_xlim, ylim = my_ylim,
         col = my_col[i])
  
  #Sys.sleep(0.2)
  
  }
polygon(c(study_area$x,study_area2$x),  c(study_area$y, study_area2$y), density = 4, angle = 135, border = rgb(1,1,1,0), lty = 3, lwd = 1.5)
polygon(c(study_area$x,study_area2$x),  c(study_area$y, study_area2$y), density = 4, angle = 45, border = rgb(1,1,1,0), lty = 3, lwd = 1.5)
    
dev.off()    
```

```{r}

my_xlim <- c(-100.3285, -78.7525)
my_ylim <- c(6.885863,31.158893)


sp::plot(country,
         ylim = my_ylim,
         xlim = my_xlim,
         bty="n",
         col = "WHITE")

i =1
sp::plot(gulf.bath[[i]], add =T,
         xlab = "", ylab = "",
         yaxt = "n", xaxt = "n",
         xlim = my_xlim, ylim = my_ylim,
         col = my_col[i])

i =2
sp::plot(gulf.bath[[i]], add =T,
         xlab = "", ylab = "",
         yaxt = "n", xaxt = "n",
         xlim = my_xlim, ylim = my_ylim,
         col = my_col[i])

i =3
sp::plot(gulf.bath[[i]], add =T,
         xlab = "", ylab = "",
         yaxt = "n", xaxt = "n",
         xlim = my_xlim, ylim = my_ylim,
         col = my_col[i])

i =4
sp::plot(gulf.bath[[i]], add =T,
         xlab = "", ylab = "",
         yaxt = "n", xaxt = "n",
         xlim = my_xlim, ylim = my_ylim,
         col = my_col[i])

i =5
sp::plot(gulf.bath[[i]], add =T,
         xlab = "", ylab = "",
         yaxt = "n", xaxt = "n",
         xlim = my_xlim, ylim = my_ylim,
         col = my_col[i])
### Outside gulf here on
i =6
sp::plot(gulf.bath[[i]], add =T,
         xlab = "", ylab = "",
         yaxt = "n", xaxt = "n",
         xlim = my_xlim, ylim = my_ylim,
         col = my_col[i])

i =7
sp::plot(gulf.bath[[i]], add =T,
         xlab = "", ylab = "",
         yaxt = "n", xaxt = "n",
         xlim = my_xlim, ylim = my_ylim,
         col = my_col[i])

i =8
sp::plot(gulf.bath[[i]], add =T,
         xlab = "", ylab = "",
         yaxt = "n", xaxt = "n",
         xlim = my_xlim, ylim = my_ylim,
         col = my_col[i])

i =9
sp::plot(gulf.bath[[i]], add =T,
         xlab = "", ylab = "",
         yaxt = "n", xaxt = "n",
         xlim = my_xlim, ylim = my_ylim,
         col = my_col[i])

i = 10
sp::plot(gulf.bath[[i]], add =T,
         xlab = "", ylab = "",
         yaxt = "n", xaxt = "n",
         xlim = my_xlim, ylim = my_ylim,
         col = my_col[i])

i = 11
sp::plot(gulf.bath[[i]], add =T,
         xlab = "", ylab = "",
         yaxt = "n", xaxt = "n",
         xlim = my_xlim, ylim = my_ylim,
         col = my_col[i])

i = 12
sp::plot(gulf.bath[[i]], add =T,
         xlab = "", ylab = "",
         yaxt = "n", xaxt = "n",
         xlim = my_xlim, ylim = my_ylim,
         col = my_col[i])

```



![Figure 3 Strat 1](figures\\Figure_1.tiff)

### Figure 2  Smooth Fits for each variable by strata and maturity (Maybe Sex)

i. display in table of plots Explanatory variables x and strata maturity (and Sex) on Y

Multiple species either multiple plots or overplotted with each other???


```{r Load  Best Models, eval = FALSE, include = FALSE}
### Strata1

load(file = "output/output_GAM/best_strat1/bn1_best.rda")
load(file = "output/output_GAM/best_strat1/bt1_best.rda")
load(file = "output/output_GAM/best_strat1/bu1_best.rda")
load(file = "output/output_GAM/best_strat1/sb1_best.rda")
load(file = "output/output_GAM/best_strat1/sn1_best.rda")
load(file = "output/output_GAM/best_strat1/si1_best.rda")
load(file = "output/output_GAM/best_strat1/sp1_best.rda")
load(file = "output/output_GAM/best_strat1/ti1_best.rda")

### Strat1 mod list 
s1M <- list(bn1_best = bn1_best,
                bt1_best = bt1_best,
                bu1_best = bu1_best,
                sb1_best = sb1_best,
                sn1_best = sn1_best,
                si1_best = si1_best,
                sp1_best = sp1_best,
                ti1_best = ti1_best)

### Strata2

load(file = "output/output_GAM/best_strat2/bn_best.rda")
load(file = "output/output_GAM/best_strat2/bt_best.rda")
load(file = "output/output_GAM/best_strat2/bu_best.rda")
load(file = "output/output_GAM/best_strat2/sb_best.rda")
load(file = "output/output_GAM/best_strat2/sn_best.rda")
load(file = "output/output_GAM/best_strat2/si_best.rda")
load(file = "output/output_GAM/best_strat2/sp_best.rda")
load(file = "output/output_GAM/best_strat2/ti_best.rda")

### Strat2 mod list
s2M <- list(bn_best = bn_best,
                bt_best = bt_best,
                bu_best = bu_best,
                sb_best = sb_best,
                sn_best = sn_best,
                si_best = si_best,
                sp_best = sp_best,
                ti_best = ti_best)

```

```{r All Lists of all Models by subset, include = FALSE, eval=FALSE}
### Just using strat2 and strat1 combined Maturity as filler for all models

s1I <- list(bn1_best = bn1_best,
                bt1_best = bt1_best,
                bu1_best = bu1_best,
                sb1_best = sb1_best,
                sn1_best = sn1_best,
                si1_best = si1_best,
                sp1_best = sp1_best,
                ti1_best = ti1_best)



s2I<- list(bn_best = bn_best,
                bt_best = bt_best,
                bu_best = bu_best,
                sb_best = sb_best,
                sn_best = sn_best,
                si_best = si_best,
                sp_best = sp_best,
                ti_best = ti_best)

rm( bn_best, bt_best, bu_best, sb_best, sn_best, si_best, sp_best, ti_best,
   bn1_best, bt1_best, bu1_best, sb1_best, sn1_best, si1_best, sp1_best, ti1_best, )

```

```{r Model structures Fig2, include = FALSE, eval=FALSE}
mod_struc_1 <- list(bn1_best = bn1_best$pred.formula,
                    bt1_best = bt1_best$pred.formula,
                    bu1_best = bu1_best$pred.formula,
                    sb1_best = sb1_best$pred.formula,
                    sn1_best = sn1_best$pred.formula,
                    si1_best = si1_best$pred.formula,
                    sp1_best = sp1_best$pred.formula,
                    ti1_best = ti1_best$pred.formula)




mod_struc_2 <- list(bn_best = bn_best$pred.formula,
                    bt_best = bt_best$pred.formula,
                    bu_best = bu_best$pred.formula,
                    sb_best = sb_best$pred.formula,
                    sn_best = sn_best$pred.formula,
                    si_best = si_best$pred.formula,
                    sp_best = sp_best$pred.formula,
                    ti_best = ti_best$pred.formula)


```

I will have to make a unique layout for each species. by look ing at the formula of the best fir model I've determined which terms are included and will use this ingormation to create a matrix for *layout()*.

```{r Layouts for Figure 2 , include = FALSE, eval=FALSE}
### Blacknose

(bn_vec <-c(1:14,
            0,0,15,16,17,0,18,
            0,0,19,20,21,0,22))

(bn_mat <- matrix(bn_vec, nrow = 4, ncol = 7, byrow = TRUE))

bn.smooth <- layout(bn_mat)

layout.show(bn.smooth)

### Blacktip
(bt_vec <- c(0,1,2,3,4,5,6,
             0,7,8,9,10,11,12,
             13,0,14,15,16,0,17,
             18,0,19,20,21,0,22))

(bt_mat <- matrix( bt_vec, nrow = 4, ncol = 7, byrow = TRUE))

bt.smooth <- layout( bt_mat )
layout.show( bt.smooth )


###  Bull
(bu_vec <- c(1,0,2,3,4,0,5,
             6,0,7,8,9,0,10,
             11,0,12,0,0,13,14,
             15,0,16,0,0,17,18))

(bu_mat <- matrix( bu_vec, nrow = 4, ncol = 7, byrow = TRUE))

bu.smooth <- layout( bu_mat )
layout.show( bu.smooth )

### sandbar
(sb_vec <- c(1:28))

(sb_mat <- matrix( sb_vec, nrow = 4, ncol = 7, byrow = TRUE))

sb.smooth <- layout( sb_mat )
layout.show( sb.smooth )
             
### Sharpnose
(sn_vec <- c(1:14,
             15:19,0,20,
             21:25,0,26))

(sn_mat <- matrix( sn_vec, nrow = 4, ncol = 7, byrow = TRUE))

sn.smooth <- layout( sn_mat )
layout.show( sn.smooth )

### Silky
(si_vec <- c(1,0,2,0,0,0,3,
             4,0,5,0,0,0,6,
             0,7,8,0,0,0,9,
             0,10,11,0,0,0,12))

(si_mat <- matrix( si_vec, nrow = 4, ncol = 7, byrow = TRUE))

si.smooth <- layout( si_mat )
layout.show( si.smooth )

### Spinner
(sp_vec <- c(1:14,
             0,15:20,
             0,21:26))

(sp_mat <- matrix( sp_vec, nrow = 4, ncol = 7, byrow = TRUE))

sp.smooth <- layout( sp_mat )
layout.show( sp.smooth )

### Tiger
(ti_vec <- c(1,0,2,3,0,0,4,
             5,0,6,7,0,0,8,
             9,10,11,12,0,13,14,
             15,16,17,18,0,19,20))

(ti_mat <- matrix( ti_vec, nrow = 4, ncol = 7, byrow = TRUE))

ti.smooth <- layout( ti_mat )
layout.show( ti.smooth )
    

lay_mat <- list(bn_mat,
                bt_mat,
                bu_mat,
                sb_mat,
                sn_mat,
                si_mat,
                sp_mat,
                ti_mat)
    
```

```{r figure 2 tiff file paths, include = FALSE, eval=FALSE}
file_name <- numeric(8)

for(i in 1:8){
  
  file_name[i] <- paste0("6_figures\\figures\\Figure_2_",letters[i], ".tiff")
}

file_name

```

```{r  Figure 2 prep, eval=FALSE, include=FALSE}



cex_txt <- 1
cex_lab <- 1.5
cex_axis <- 1.25
my_lwd <- 1.75
y_line <- 1.25
x_line <- -0.75

letter_line <- -0.75
letter_at <- 0

sleep_time <- 0.01

```

```{r Figure 2 plots Loop, include=FALSE, eval = FALSE}


  
  for(i in 1:8){
    
    tiff(filename =  file_name[i], height = 2000, width = 2500, res = 300)
  
  par(oma = c(1.5, 3.25, 1, 1), # two rows of text at the outer left and bottom margin
    mar = c(1, 1, 1, 1), # space for one row of text at ticks and to separate plots
    mgp = c(1.75, 0.75, 0))
  
  layout( lay_mat[[i]] ) 
   
  ### Strat1 Mature
  for(j in 2:8){
    
    
    plot(s1M[[i]], select = j,
         xlab = "", ylab = "",
         main = "",
         lwd= my_lwd, 
         cex.axis = cex_axis, 
         cex.lab = cex_lab, 
         bty = "n")
    
    abline( h = 0, col = "blue", lty = 3)
    
  }
  ### Strat1 Immature
    for(j in 2:8){
    
    plot(s1I[[i]], select = j,
          xlab = "", ylab = "",
         main= "",
         lwd= my_lwd, 
         cex.axis = cex_axis, 
         cex.lab = cex_lab, 
         bty = "n")
    
    abline( h = 0, col = "blue", lty = 3)
    
    }
  ### Strat 2 Mature
    for(j in 2:8){
    
    plot(s2M[[i]], select = j,
          xlab = "", ylab = "",
         main= "",
         lwd= my_lwd, 
         cex.axis = cex_axis, 
         cex.lab = cex_lab, 
         bty = "n")
    
    abline( h = 0, col = "blue", lty = 3)
    
    }
  ### Strat 2 Immature
    for(j in 2:8){
    
    plot(s2I[[i]], select = j,
          xlab = "", ylab = "",
         main= "",
         lwd= my_lwd, 
         cex.axis = cex_axis, 
         cex.lab = cex_lab, 
         bty = "n")
    
    abline( h = 0, col = "blue", lty = 3)
    
    }
### Y labels
    mtext("Strat 1 Mature",
        side = 2, 
        at = 0.875,
        line = y_line,
        cex = cex_txt, 
        outer = TRUE)
  
    mtext("Strat 1 Immature",
        side = 2,
        at = 0.625,
        line = y_line,
        cex = cex_txt,
        outer = TRUE)
    
      mtext("Strat 2 Mature",
        side = 2, 
        at = 0.375,
        line = y_line,
        cex = cex_txt,
        outer = TRUE)
      
        mtext("Strat 2 Immature",
        side = 2, 
        at = 0.125,
        line = y_line,
        cex = cex_txt,
        outer = TRUE)
  ### X Labels
        mtext("Depth",
        side = 3, 
        at = 1/14,
        line = x_line,
        cex = cex_txt,
        outer = TRUE)
        
        mtext("Temp",
        side = 3, 
        at = 3/14,
        line = x_line,
        cex = cex_txt,
        outer = TRUE)
        
        mtext("Turb",
        side = 3, 
        at = 5/14,
        line = x_line,
        cex = cex_txt,
        outer = TRUE)
        
        mtext("Oxy",
        side = 3, 
        at = 1/2,
        line = x_line,
        cex = cex_txt,
        outer = TRUE)
        
        mtext("Sal",
        side = 3, 
        at = 9/14,
        line = x_line,
        cex = cex_txt,
        outer = TRUE)
        
        mtext("Distance",
        side = 3, 
        at = 11/14,
        line = x_line,
        cex = cex_txt,
        outer = TRUE)
       
         mtext("Year",
        side = 3, 
        at = 13/14,
        line = x_line,
        cex = cex_txt,
        outer = TRUE)
        
         ### Figure letter
        mtext(paste0("(", letters[i], ")"),
        side = 3, 
        at = letter_at,
        line = letter_line,
        cex = cex_txt,
        outer = TRUE) 
         
        
        Sys.sleep(sleep_time)
        
        dev.off()
        
        }
  



```

![**Figure 2 a**](figures\\Figure_2_a.tiff)

![Figure 2 b](figures\\Figure_2_b.tiff)

![Figure 2 c](figures\\Figure_2_c.tiff)

![Figure 2 d](figures\\Figure_2_d.tiff)

![Figure 2 e](figures\\Figure_2_e.tiff)

![Figure 2 f](figures\\Figure_2_f.tiff)

![Figure 2 g](figures\\Figure_2_g.tiff)

![Figure 2 h](figures\\Figure_2_h.tiff)



### Figure 3 Heat Map showing CPUE by area in nGoM

i. maybe show map with presence and abscense of each species aswell 
ii. either species 4 rows by 2 columns Or consider year to year comparison of each species


```{r figure 3 model list, include=FALSE, eval=TRUE}
### Strata1

load(file = "output/output_GAM/best_strat1/bn1_best.rda")
load(file = "output/output_GAM/best_strat1/bt1_best.rda")
load(file = "output/output_GAM/best_strat1/bu1_best.rda")
load(file = "output/output_GAM/best_strat1/sb1_best.rda")
load(file = "output/output_GAM/best_strat1/sn1_best.rda")
load(file = "output/output_GAM/best_strat1/si1_best.rda")
load(file = "output/output_GAM/best_strat1/sp1_best.rda")
load(file = "output/output_GAM/best_strat1/ti1_best.rda")




s1 <- list(bn1_best = bn1_best,
           bt1_best = bt1_best,
           bu1_best = bu1_best,
           sb1_best = sb1_best,
           sn1_best = sn1_best,
           si1_best = si1_best,
           sp1_best = sp1_best,
           ti1_best = ti1_best)

### Strata2

load(file = "output/output_GAM/best_strat2/bn_best.rda")
load(file = "output/output_GAM/best_strat2/bt_best.rda")
load(file = "output/output_GAM/best_strat2/bu_best.rda")
load(file = "output/output_GAM/best_strat2/sb_best.rda")
load(file = "output/output_GAM/best_strat2/sn_best.rda")
load(file = "output/output_GAM/best_strat2/si_best.rda")
load(file = "output/output_GAM/best_strat2/sp_best.rda")
load(file = "output/output_GAM/best_strat2/ti_best.rda")


s2 <- list(bn_best = bn_best,
           bt_best = bt_best,
           bu_best = bu_best,
           sb_best = sb_best,
           sn_best = sn_best,
           si_best = si_best,
           sp_best = sp_best,
           ti_best = ti_best)

rm( bn_best, bt_best, bu_best, sb_best, sn_best, si_best, sp_best, ti_best,
   bn1_best, bt1_best, bu1_best, sb1_best, sn1_best, si1_best, sp1_best, ti1_best, )
```

```{r load shape file, include=FALSE, eval=TRUE}
require(maptools)
require(sp)
library(rgdal)
library(lubridate)


gulf.shape <- "shape-file\\Shape\\stateshigh.shp"
gulf.shape <- maptools::readShapePoly(gulf.shape)


```

```{r fig3 prep, include=FALSE, eval=TRUE }
plot_tag <- letters[1:8]


my_xlim <- c(-97.5, -81)

my_ylim <- c(24.5,30.5)

x_ticks <- seq(-98, -81)
#-80.75, -81.25
y_ticks <- round(seq(24.5, 30.5, length.out = 5),1)


cex_pts <- 0.425
col_pts <- rgb(0.25,0.25,0.25,0.25) ### only for Strata 1
cex_legend <- 1.25

lwd_axis <- 1
cex_axis <- 1
cex_mtxt <- 1

Lon_line <- 2
Lat_line <- 2.5

```

#### Figure 3 Strata 1

```{r Figure 3 Strata 1tiff, include=FALSE, eval=FALSE}
tiff(filename = "6_figures\\figures\\Figure_3_S1.tiff", width = 2000,  height = 2000, res = 300)
```

```{r Figure 3 Strata 1 All plots, include=FALSE, eval=TRUE}
par(mfrow = c(4, 2),     # 4x2 layout
    oma = c(2.75, 3.5, 0, 0), # two rows of text at the outer left and bottom margin
    mar = c(0.5, 0.5, 0, 0), # space for one row of text at ticks and to separate plots
    mgp = c(2, 0.75, 0))    # axis label at 2 rows distance, tick labels at 1 row

for(i in 1:length(s1)){
  
  vis.gam(s1[[i]],
          view = c("STARTLON", "STARTLAT"),
          xlim = my_xlim, ylim = my_ylim,
          xlab = "", ylab = "",
          xaxt = "n", yaxt = "n",
          plot.type = "contour", 
          too.far = 0.07, 
          n.grid = 120, 
          main = "",
          bty = "n", 
          cond = list(YEAR = 2013))

par(new=T)

plot(strat2[[i]]$STARTLON,
     strat2[[i]]$STARTLAT,
     xlim = my_xlim, ylim = my_ylim,
     xlab = "", ylab = "",
     xaxt = "n", yaxt = "n",
     pch = 20,
     bty="n",
     cex = cex_pts)

par(new=T)

plot(zero[[i]]$STARTLON,
     zero[[i]]$STARTLAT,
     xlim = my_xlim, ylim = my_ylim,
     xlab = "", ylab = "",
     xaxt = "n", yaxt = "n",
     pch = 21,
     bty="n",
     cex = cex_pts,
     col = col_pts)

par(new=T)

sp::plot(gulf.shape, add= T,
         xlim = my_xlim, ylim = my_ylim,
         xlab = "", ylab = "",
         xaxt = "n", yaxt = "n",
         col = "gray",
         bty="n")

legend("topleft",
       legend = paste0("(", plot_tag[i], ")"),
       bty="n",
       bg = "gray",
       cex = cex_legend)

if(i == 1 | i == 3 | i == 5){
  
    axis(2,
     at = y_ticks,
     las = 2,
     lwd = lwd_axis,
     cex.axis = cex_axis)
  
    mtext("Latitude",
      side = 2,
      line = Lat_line,
      cex = cex_mtxt)
  

}

if(i == 7){
  
    axis(1,
     at = x_ticks,
     lwd = lwd_axis,
     cex.axis = cex_axis)
  
    mtext("Longitude",
      side = 1,
      line = Lon_line,
      cex = cex_mtxt)    
  
  axis(2,
     at = y_ticks,
     las = 2,
     lwd = lwd_axis,
     cex.axis = cex_axis)
  
    mtext("Latitude",
      side = 2,
      line = Lat_line,
      cex = cex_mtxt)
  
}

if( i == 8){
  
  axis(1,
     at = x_ticks,
     lwd = lwd_axis,
     cex.axis = cex_axis)
  
    mtext("Longitude",
      side = 1,
      line = Lon_line,
      cex = cex_mtxt)

  
}


  
}

#dev.off()
```

![Figure 3 Strat 1](figures\\Figure_3_S1.tiff)


#### Figure 3 Strata 2

```{r Figure 3 Strata 2tiff, include=FALSE, eval=FALSE}
tiff(filename = "6_figures\\figures\\Figure_3_S2.tiff", width = 2000,  height = 2000, res = 300)
```

```{r Figure 3 Strata 2 All plots, include=FALSE, eval=TRUE}
par(mfrow = c(4, 2),     # 4x2 layout
    oma = c(2.75, 3.5, 0, 0), # two rows of text at the outer left and bottom margin
    mar = c(0.5, 0.5, 0, 0), # space for one row of text at ticks and to separate plots
    mgp = c(2, 0.75, 0))    # axis label at 2 rows distance, tick labels at 1 row

for(i in 1:length(s2)){
  
  vis.gam(s2[[i]],
          view = c("STARTLON", "STARTLAT"),
          xlim = my_xlim, ylim = my_ylim,
          xlab = "", ylab = "",
          xaxt = "n", yaxt = "n",
          plot.type = "contour", 
          too.far = 0.07, 
          n.grid = 120, 
          main = "",
          bty = "n", 
          cond = list(YEAR = 2013))

par(new=T)

plot(strat2[[i]]$STARTLON,
     strat2[[i]]$STARTLAT,
     xlim = my_xlim, ylim = my_ylim,
     xlab = "", ylab = "",
     xaxt = "n", yaxt = "n",
     pch = 20,
     bty="n",
     cex = cex_pts)

par(new=T)

sp::plot(gulf.shape, add= T,
         xlim = my_xlim, ylim = my_ylim,
         xlab = "", ylab = "",
         xaxt = "n", yaxt = "n",
         col = "gray",
         bty="n")

legend("topleft",
       legend = paste0("(", plot_tag[i], ")"),
       bty="n",
       bg = "gray",
       cex = cex_legend)

if(i == 1 | i == 3 | i == 5){
  
    axis(2,
     at = y_ticks,
     las = 2,
     lwd = lwd_axis,
     cex.axis = cex_axis)
  
    mtext("Latitude",
      side = 2,
      line = Lat_line,
      cex = cex_mtxt)
  

}

if(i == 7){
  
    axis(1,
     at = x_ticks,
     lwd = lwd_axis,
     cex.axis = cex_axis)
  
    mtext("Longitude",
      side = 1,
      line = Lon_line,
      cex = cex_mtxt)    
  
  axis(2,
     at = y_ticks,
     las = 2,
     lwd = lwd_axis,
     cex.axis = cex_axis)
  
    mtext("Latitude",
      side = 2,
      line = Lat_line,
      cex = cex_mtxt)
  
}

if( i == 8){
  
  axis(1,
     at = x_ticks,
     lwd = lwd_axis,
     cex.axis = cex_axis)
  
    mtext("Longitude",
      side = 1,
      line = Lon_line,
      cex = cex_mtxt)

  
}


  
}

#dev.off()
```

![Figure 3 Strat 2](figures\\Figure_3_S2.tiff)

























































