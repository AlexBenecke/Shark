---
title: "Shark Result Report 10-19-2018"
author: "Alex Benecke"
date: "October 15, 2018"
output:   
  html_document:
    df_print: paged
    toc: true
    toc_float: true
    toc_depth: 3
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message=FALSE, warning = FALSE)
```

```{r Load Packages, eval=TRUE, include=FALSE}
### Load Packages
library(FSA)
library(tidyverse)
library(dplyr)
library(magrittr)
library(scales)
library(mgcv)
library(sciplot)
library(knitr)
library(kableExtra)
library(pipeR)


#source("plot_centered_mean.R")

source("5_functions/dropbox_fn.R") # For interacting with dropbox
proj = "shark" # Specify project where data is stored 

source("5_functions/model_selection_fn.R")

source("5_functions/load_data.R")
```


# Overview of Data and Descriptive Statistics


### Table 1

Number of stations with positive catch of sharks by year. Total column is the sum of each row and reflects the sample size for strata 2 GAMs (abundance). The row totals are the number of stations where a particular species, sex and maturity was observer during 2001 to 2017. Bottom row gives the Total number of stations sampled each year. 

```{r}
pres.tbl <- read_csv_fn("data/clean-data/table-data/pres_tbl.csv", proj)

names(pres.tbl) <- c("Species", "Sex", "Maturity", "2001", "2002", "2003", "2004", "2005", "2006", "2007",
                     "2008", "2009", "2010", "2011", "2012", "2013", "2014", "2015", "2016", "2017", "Total" )

```
```{r Make table of positive catch sites per year, eval=TRUE, include=TRUE}
pres.tbl %>%
  kable() %>%
  kable_styling(full_width = F, 
                position = "center", 
                font_size = 12,
                bootstrap_options = "striped") %>%
  column_spec(1, bold = T, background = "White") %>%
  column_spec(2, background = "White") %>%
  column_spec(21, border_left = T) %>%
  collapse_rows(c(1:2), valign = "middle")
```

### Table 2

Some Basic discriptive statistics of the numeric explanatory variables. right half gives the pairwise correlation between variables.

```{r}
var.tbl.2 <- read_csv_fn("data/clean-data/table-data/Table2.csv",proj)
```
```{r, eval=TRUE, include=TRUE}
var.tbl.2 %>%
  kable() %>%
  kable_styling(full_width = F, 
                position = "center", 
                font_size = 12,
                bootstrap_options = "striped") %>%
  add_header_above(c(" " = 5, "Correlation Table" = 6)) #%>%
  #save_kable(file = "Table2.html", self_contained = T)
```




# Models fit and selection





## Sharpnose

### Table 3 

  Top 3 models fit for each strata, sex and maturity of Sharpnose sharks ranked by AIC. $95\% ~ Confidence set$ gives to number of models with cumulative AIC Wieght less than 0.95. Delta AIV less than 4 gives the number of models selected with an AIC less than four.
  
  $$AIC ~ Weight = \frac{e^{-1/2 \Delta AIC_i}}{\sum_{i=1}^ne^{-1/2 \Delta AIC_i}}$$

```{r}
table3 <- read_csv_fn("data/clean-data/table-data/Table3.csv", proj) #%>%

table3$AIC <- round(table3$AIC, 3)  
table3$delta.AIC <- round(table3$delta.AIC, 3) 
table3$AIC.Weight <- round(table3$AIC.Weight, 3) 
table3$Cumulative.Weight <- round(table3$Cumulative.Weight, 3) 
  
names(table3) <- c("Species", "Strata", "Sex", "Maturity", "Model Formula", "No. Of Parameters", "AIC", "delta AIC", 
                   "AIC Weight", "Cumulative Weight", "Deviance Explained", "95% Confidence set (n)", "delta AIC < 4 (n)")

sn_tbl3 <- subset(table3, Species == "Sharpnose")
rownames(sn_tbl3) <- NULL
```
```{r}
sn_tbl3 %>%
  kable() %>%
  kable_styling("striped", 
                full_width = TRUE, 
                position = "left"
                ) %>%
  column_spec(5, width_min = "8cm") %>%
  collapse_rows(columns = c(1:4,12,13), valign = "middle")
```

### Table 4 

The relative importance of each variable in best subset of models ($\Delta AIC < 4$) for each strata, sex and maturity for Sharpnose sharks.  

```{r}
table4 <- read_csv_fn("data/clean-data/table-data/Table4.csv", proj) %>%
  mutate(Depth = round(Depth, 3), Temperature = round(Temperature,3), Turbidity = round(Turbidity,3), Oxygen = round(Oxygen,3), 
         Salinity = round(Salinity,3), Distance.to.Shore = round(Distance.to.Shore,3), Bottom.Type = round(Bottom.Type,3))

names(table4) <- c("Species", "Strata", "Sex", "Maturity", "Depth", "Temperature", "Turbidity", "Oxygen", "Salinity", "Distance to Shore", "Bottom Type")

sn_table4 <- subset(table4, Species =="Sharpnose")
rownames(sn_table4) <- NULL
```
```{r}
sn_table4 %>%
  kable() %>%
  kable_styling("striped",
                full_width = F, 
                position = "center",
                font_size = 14) %>%
  collapse_rows(columns = c(1:3), valign = "middle")
```


### Figure 2 

Smooths for best fit models for each stata, sex and maturity of Sharpnose sharks. X-axis is the range of the explanatory variable given at the top of each column. Y-axis represents the magnitude of the predictor variables effect of the response. Shaded areas represent the $95 \% CI$.

#### Strata 1 $P(Occurrence)$

```{r, include=FALSE}
filenames_s1 <- list.files("output/output_GAM/best/sharpnose/strat1",
                           pattern="*.rda", full.names=TRUE)

lapply(filenames_s1, load, .GlobalEnv)


rm( filenames_s1 )

sn_mod_s1 = list(    # Sharpnose
  sn_s1_FA_best = sn_s1_FA_best, ## sn s1
  sn_s1_FJ_best = sn_s1_FJ_best,
  sn_s1_MA_best = sn_s1_MA_best,
  sn_s1_MJ_best = sn_s1_MJ_best
  )
                
```
```{r, include=FALSE}
sn_row_1 <- c( 1, 2, 3, 4, 5, 6, 7)
sn_row_2 <- c( 8, 9, 10, 0, 0, 0, 11)
sn_row_3 <- c( 12, 13, 14, 15, 16, 0, 17)
sn_row_4 <- c( 18, 19, 0, 0, 20, 0, 21)

(sn_mat_s1 <- matrix(c(sn_row_1, sn_row_2, sn_row_3, sn_row_4),
                  nrow = 4, ncol = 7, byrow = TRUE) )
sn.lay.s1 <- layout( sn_mat_s1 )
#layout.show( sn.lay.s1 )

lay_mat_s1 <- sn_mat_s1
                   
```
```{r, include=FALSE}
cex_txt <- 2
cex_lab <- 2.5
cex_axis <- 2.25
my_lwd <- 2.25
y_line <- 1.5
x_line <- 0

letter_line <- 0
letter_at <- 0

sleep_time <- 0.01
```

```{r, include=TRUE, fig.width=18, fig.height=14} 

  par(oma = c(1.5, 4.25, 2.5, 1), # two rows of text at the outer left and bottom margin
    mar = c(1, 1, 1, 1), # space for one row of text at ticks and to separate plots
    mgp = c(1.75, 0.75, 0))
  
  layout( lay_mat_s1 )


for(j in 1:length( sn_mod_s1 ) ){ ### loop through Sex, and Maturity level of mod_lst_s1 
      
      for(k in 2:8){ ## Loop through specific variables in each level of sex and maturity for specific species
    
    plot(sn_mod_s1[[j]], select = k,
         scale = 0,
         shade = TRUE,
         xlab = "", ylab = "",
         main = "",
         lwd= my_lwd, 
         cex.axis = cex_axis, 
         cex.lab = cex_lab, 
         bty = "n")
    
    abline( h = 0, col = "blue", lty = 3)  
    
    Sys.sleep(sleep_time)
    
    }
      
    }
  
  ### Y labels
    mtext("Female Adult ",
        side = 2, 
        at = 0.875,
        line = y_line,
        cex = cex_txt, 
        outer = TRUE)
  
    mtext("Female Juvenile",
        side = 2,
        at = 0.625,
        line = y_line,
        cex = cex_txt,
        outer = TRUE)
    
      mtext("Male Adult",
        side = 2, 
        at = 0.375,
        line = y_line,
        cex = cex_txt,
        outer = TRUE)
      
        mtext("Male Juvenile",
        side = 2, 
        at = 0.125,
        line = y_line,
        cex = cex_txt,
        outer = TRUE)
  ### X Labels
        mtext("Depth",
        side = 3, 
        at = 1/14,
        line = x_line,
        cex = cex_txt,
        outer = TRUE)
        
        mtext("Temp",
        side = 3, 
        at = 3/14,
        line = x_line,
        cex = cex_txt,
        outer = TRUE)
        
        mtext("Turb",
        side = 3, 
        at = 5/14,
        line = x_line,
        cex = cex_txt,
        outer = TRUE)
        
        mtext("Oxy",
        side = 3, 
        at = 1/2,
        line = x_line,
        cex = cex_txt,
        outer = TRUE)
        
        mtext("Sal",
        side = 3, 
        at = 9/14,
        line = x_line,
        cex = cex_txt,
        outer = TRUE)
        
        mtext("Distance",
        side = 3, 
        at = 11/14,
        line = x_line,
        cex = cex_txt,
        outer = TRUE)
       
         mtext("Year",
        side = 3, 
        at = 13/14,
        line = x_line,
        cex = cex_txt,
        outer = TRUE)
        
         ### Figure letter
        mtext("(e)",
        side = 3, 
        at = letter_at,
        line = letter_line,
        cex = cex_txt,
        outer = TRUE) 
```

```{r, include=FALSE}
rm(sn_mod_s1, sn_s1_FA_best, sn_s1_FJ_best, sn_s1_MA_best, sn_s1_MJ_best, lay_mat_s1, sn_mat_s1, j, k,
   sn_row_1, sn_row_2, sn_row_3, sn_row_4, sn.lay.s1)
rm(cex_txt, cex_lab, cex_axis, my_lwd, y_line, x_line, letter_line, letter_at, sleep_time)
```


#### strata 2 Abundance

```{r, include=FALSE}
filenames_s2 <- list.files("output/output_GAM/best/sharpnose/strat2",
                           pattern="*.rda", full.names=TRUE)

lapply(filenames_s2, load, .GlobalEnv)


rm( filenames_s2 )

sn_mod_s2 = list(    # Sharpnose
  sn_s2_FA_best = sn_s2_FA_best, ## sn s1
  sn_s2_FJ_best = sn_s2_FJ_best,
  sn_s2_MA_best = sn_s2_MA_best,
  sn_s2_MJ_best = sn_s2_MJ_best
  )
                
```
```{r, include=FALSE}
sn_row_5 <- c( 1, 2, 3, 0, 0, 0, 4)
sn_row_6 <- c( 0, 5, 6, 0, 0, 7, 8)
sn_row_7 <- c( 9, 0, 10, 0, 0, 0, 11)
sn_row_8 <- c( 0, 12, 0, 13, 14, 0, 15)

(sn_mat_s2 <- matrix(c(sn_row_5, sn_row_6, sn_row_7, sn_row_8),
                  nrow = 4, ncol = 7, byrow = TRUE) )

sn.lay.s2 <- layout( sn_mat_s2 )
layout.show( sn.lay.s2 )
```
```{r, include=FALSE}
cex_txt <- 2
cex_lab <- 2.5
cex_axis <- 2.25
my_lwd <- 2.25
y_line <- 1.5
x_line <- 0

letter_line <- 0
letter_at <- 0

sleep_time <- 0.01
```

```{r, include=TRUE, fig.width=18, fig.height=14}
  par(oma = c(1.5, 4.25, 2.5, 1), # two rows of text at the outer left and bottom margin
    mar = c(1, 1, 1, 1), # space for one row of text at ticks and to separate plots
    mgp = c(1.75, 0.75, 0))
  
  layout( sn_mat_s2 )
  
for(j in 1:length(sn_mod_s2)){ ## Loop through Sex and maturity levels for a species
  
  for(k in 2:8){ ## loop through explanatory variables in one level of sex and maturity for a species
    
    plot(sn_mod_s2[[j]], select = k,
         scale = 0,
         shade = TRUE,
         xlab = "", ylab = "",
         main = "",
         lwd= my_lwd, 
         cex.axis = cex_axis, 
         cex.lab = cex_lab, 
         bty = "n")
    
    abline( h = 0, col = "blue", lty = 3)    
    
  }   
  
} 
  
  
  ### Y labels
    mtext("Female Adult ",
        side = 2, 
        at = 0.875,
        line = y_line,
        cex = cex_txt, 
        outer = TRUE)
  
    mtext("Female Juvenile",
        side = 2,
        at = 0.625,
        line = y_line,
        cex = cex_txt,
        outer = TRUE)
    
      mtext("Male Adult",
        side = 2, 
        at = 0.375,
        line = y_line,
        cex = cex_txt,
        outer = TRUE)
      
        mtext("Male Juvenile",
        side = 2, 
        at = 0.125,
        line = y_line,
        cex = cex_txt,
        outer = TRUE)
  ### X Labels
        mtext("Depth",
        side = 3, 
        at = 1/14,
        line = x_line,
        cex = cex_txt,
        outer = TRUE)
        
        mtext("Temp",
        side = 3, 
        at = 3/14,
        line = x_line,
        cex = cex_txt,
        outer = TRUE)
        
        mtext("Turb",
        side = 3, 
        at = 5/14,
        line = x_line,
        cex = cex_txt,
        outer = TRUE)
        
        mtext("Oxy",
        side = 3, 
        at = 1/2,
        line = x_line,
        cex = cex_txt,
        outer = TRUE)
        
        mtext("Sal",
        side = 3, 
        at = 9/14,
        line = x_line,
        cex = cex_txt,
        outer = TRUE)
        
        mtext("Distance",
        side = 3, 
        at = 11/14,
        line = x_line,
        cex = cex_txt,
        outer = TRUE)
       
         mtext("Year",
        side = 3, 
        at = 13/14,
        line = x_line,
        cex = cex_txt,
        outer = TRUE)
        
         ### Figure letter
        mtext(paste0("(f)"),
        side = 3, 
        at = letter_at,
        line = letter_line,
        cex = cex_txt,
        outer = TRUE) 
```

```{r, include=FALSE}
rm(sn_mod_s2, sn_s2_FA_best, sn_s2_FJ_best, sn_s2_MA_best, sn_s2_MJ_best, lay_mat_s2, sn_mat_s2, j, k,
   sn_row_5, sn_row_6, sn_row_7, sn_row_8, sn.lay.s2)
rm(cex_txt, cex_lab, cex_axis, my_lwd, y_line, x_line, letter_line, letter_at, sleep_time)
```

#### Bottype

```{r, include=FALSE}
lapply(c("output/output_GAM/best/sharpnose/strat1/sn_s1_MA_best.rda",
                             "output/output_GAM/best/sharpnose/strat2/sn_s2_FJ_best.rda",
                             "output/output_GAM/best/sharpnose/strat2/sn_s2_MA_best.rda"), load, .GlobalEnv)

sn_mod_lst = list(    # Sharpnose
  sn_s1_MA_best = sn_s1_MA_best,
  sn_s2_FJ_best = sn_s2_FJ_best,
  sn_s2_MA_best = sn_s2_MA_best
  )
```
```{r, fig.width=14}
par(mfrow = c(1,2))
plot(sn_mod_lst$sn_s1_MA_best, all.terms = TRUE, select = 8, scale = 0, se = TRUE, bty = "n")
mtext("Adult Male Sharpnose Strata 1", side = 3, cex = 2)


plot(sn_mod_lst$sn_s2_FJ_best, all.terms = TRUE, select = 6, scale = 0, se = TRUE, bty = "n")
mtext("Juvenile Female Sharpnose Strata 2", side = 3, cex = 2)

par(mfrow = c(1,2))
plot(sn_mod_lst$sn_s2_MA_best, all.terms = TRUE, select = 5, scale = 0, se = TRUE, bty = "n")
mtext("Adult Male Sharpnose Strata 2", side = 3, cex = 2)
```




### Figure 3 
```{r, include=FALSE, message=FALSE}
require(maptools)
require(sp)
require(rgdal)
require(lubridate)

gulf.shape <- "shape-file\\Shape\\stateshigh.shp"
gulf.shape <- maptools::readShapePoly(gulf.shape)

```


```{r, include=FALSE, message=FALSE}
eff3 <- read_csv_fn( "data/clean-data/CPUE3.csv", proj)

strat1_Adult <- load_data(data = eff3[eff3$maturity == "A",] %>% droplevels(), strata = 1, fact_vars = FALSE)
strat1_Juvenile <- load_data(data = eff3[eff3$maturity == "J",] %>% droplevels(), strata = 1, fact_vars = FALSE)

strat2_Adult <- load_data(data = eff3[eff3$maturity == "A",] %>% droplevels(), strata = 2, fact_vars = FALSE)
strat2_Juvenile <- load_data(data = eff3[eff3$maturity == "J",] %>% droplevels(), strata = 2, fact_vars = FALSE)

df_1_lst <- list(blacknose_Female_Adult = strat1_Adult$Female$blacknose,
                 blacknose_Male_Adult = strat1_Adult$Male$blacknose,
                 blacknose_Female_Juvenile = strat1_Juvenile$Female$blacknose,
                 blacknose_Male_Juvenile = strat1_Juvenile$Male$blacknose
                 ,
                 blacktip_Female_Adult = strat1_Adult$Female$blacktip,
                 blacktip_Male_Adult = strat1_Adult$Male$blacktip,
                 blacktip_Female_Juvenile = strat1_Juvenile$Female$blacktip,
                 blacktip_Male_Juvenile = strat1_Juvenile$Male$blacktip
                 ,
                 sharpnose_Female_Adult = strat1_Adult$Female$sharpnose,
                 sharpnose_Male_Adult = strat1_Adult$Male$sharpnose,
                 sharpnose_Female_Juvenile = strat1_Juvenile$Female$sharpnose,
                 sharpnose_Male_Juvenile = strat1_Juvenile$Male$sharpnose
)

df_2_lst <- list(blacknose_Female_Adult = strat2_Adult$Female$blacknose,
                 blacknose_Male_Adult = strat2_Adult$Male$blacknose,
                 blacknose_Female_Juvenile = strat2_Juvenile$Female$blacknose,
                 blacknose_Male_Juvenile = strat2_Juvenile$Male$blacknose
                 ,
                 blacktip_Female_Adult = strat2_Adult$Female$blacktip,
                 blacktip_Male_Adult = strat2_Adult$Male$blacktip,
                 blacktip_Female_Juvenile = strat2_Juvenile$Female$blacktip,
                 blacktip_Male_Juvenile = strat2_Juvenile$Male$blacktip
                 ,
                 sharpnose_Female_Adult = strat2_Adult$Female$sharpnose,
                 sharpnose_Male_Adult = strat2_Adult$Male$sharpnose,
                 sharpnose_Female_Juvenile = strat2_Juvenile$Female$sharpnose,
                 sharpnose_Male_Juvenile = strat2_Juvenile$Male$sharpnose
)

rm(strat1_Adult, strat1_Juvenile, strat2_Adult, strat2_Juvenile, eff3)

```
```{r, include=FALSE, message=FALSE}
filenames <- list.files("output/output_GAM/raster",
                        pattern = "*.Rdata",
                        full.names = TRUE)


for(i in 1:length(filenames)){
  
  load(filenames[i])
  
}
```
```{r, include=FALSE, message=FALSE}
### Figure Options

cex_pts <- 2
pch_pts <- "."

line_top <- 0

cex_txt <- 2.25

my_xlim = c(-100,-80)
my_ylim = c(22,33)

```


#### Layer 3 ($P(Occurrence) \times Abundance$)

Estimated CPUE multiplied by probability of occurance. Darker/green color reflects higher CPUE. White areas are areas outside sampling region where no predictions where made. 

```{r, message=FALSE, fig.width=14}
layer <- 3

par(mfrow = c(1,2),
    oma = c(0,2,2,1),
    mar = c(3,3,0.5,0.5)#c(2,4,3,1)
    )

## FA
plot(raster_sharpnose_FA[[layer]])

sp::plot(gulf.shape, add= T,
         xlab = "", ylab = "",
         xlim = my_xlim, ylim = my_ylim,
         #xaxt = "n", yaxt = "n",
         col = "gray",
         bty="n")

points(startlat~startlon, 
       data = df_2_lst$sharpnose_Female_Adult,
       xlim = my_xlim, ylim = my_ylim,
       pch = pch_pts,
       col = "black",
       #bg="black",
       cex = cex_pts)

## FJ
plot(raster_sharpnose_FJ[[layer]], bty = "n")

sp::plot(gulf.shape, add= T,
         xlab = "", ylab = "",
         xlim = my_xlim, ylim = my_ylim,
         #xaxt = "n", yaxt = "n",
         col = "gray",
         bty="n")

points(startlat~startlon, 
       data = df_2_lst$sharpnose_Female_Juvenile,
       xlim = my_xlim, ylim = my_ylim,
       pch = pch_pts,
       col = "black",
       #bg="black",
       cex = cex_pts)

mtext("Adult",
      side = 3,
      at=1/4,
      outer = TRUE,
      cex = cex_txt,
      line = line_top)

mtext("Juvenile",
      side = 3,
      at=3/4,
      outer = TRUE,
      cex = cex_txt,
      line = line_top)

mtext("Female",
      side = 2,
      at=2/4,
      outer = TRUE,
      cex = cex_txt)

mtext("(c)",
      side = 3, 
      at = 0.025,
      line = line_top,
      cex=cex_txt,
      outer = TRUE)

par(mfrow = c(1,2),
    oma = c(0,2,2,1),
    mar = c(3,3,0.5,0.5)#c(2,4,3,1)
    )

## MA
plot(raster_sharpnose_MA[[layer]], bty = "n")

sp::plot(gulf.shape, add= T,
         xlab = "", ylab = "",
         xlim = my_xlim, ylim = my_ylim,
         #xaxt = "n", yaxt = "n",
         col = "gray",
         bty="n")

points(startlat~startlon, 
       data = df_2_lst$sharpnose_Male_Adult,
       xlim = my_xlim, ylim = my_ylim,
       pch = pch_pts,
       col = "black",
       #bg="black",
       cex = cex_pts)

## MJ
plot(raster_sharpnose_MJ[[layer]], bty = "n")

sp::plot(gulf.shape, add= T,
         xlab = "", ylab = "",
         xlim = my_xlim, ylim = my_ylim,
         #xaxt = "n", yaxt = "n",
         col = "gray",
         bty="n")

points(startlat~startlon, 
       data = df_2_lst$sharpnose_Male_Juvenile,
       xlim = my_xlim, ylim = my_ylim,
       pch = pch_pts,
       col = "black",
       #bg="black",
       cex = cex_pts)



mtext("Male",
      side = 2,
      at=2/4,
      outer = TRUE,
      cex = cex_txt)



```

#### Layer 1 (Strata 1 $P(Occurrence)$)

Darker/green color reflects higher probability of occurance. White areas are areas outside sampling region where no predictions where made. 

```{r, message=FALSE, fig.width=14}
layer <- 1

par(mfrow = c(1,2),
    oma = c(0,2,2,1),
    mar = c(3,3,0.5,0.5)#c(2,4,3,1)
    )

## FA
plot(raster_sharpnose_FA[[layer]])

sp::plot(gulf.shape, add= T,
         xlab = "", ylab = "",
         xlim = my_xlim, ylim = my_ylim,
         #xaxt = "n", yaxt = "n",
         col = "gray",
         bty="n")

points(startlat~startlon, 
       data = df_2_lst$sharpnose_Female_Adult,
       xlim = my_xlim, ylim = my_ylim,
       pch = pch_pts,
       col = "black",
       #bg="black",
       cex = cex_pts)

## FJ
plot(raster_sharpnose_FJ[[layer]], bty = "n")

sp::plot(gulf.shape, add= T,
         xlab = "", ylab = "",
         xlim = my_xlim, ylim = my_ylim,
         #xaxt = "n", yaxt = "n",
         col = "gray",
         bty="n")

points(startlat~startlon, 
       data = df_2_lst$sharpnose_Female_Juvenile,
       xlim = my_xlim, ylim = my_ylim,
       pch = pch_pts,
       col = "black",
       #bg="black",
       cex = cex_pts)

mtext("Adult",
      side = 3,
      at=1/4,
      outer = TRUE,
      cex = cex_txt,
      line = line_top)

mtext("Juvenile",
      side = 3,
      at=3/4,
      outer = TRUE,
      cex = cex_txt,
      line = line_top)

mtext("Female",
      side = 2,
      at=2/4,
      outer = TRUE,
      cex = cex_txt)

mtext("(c)",
      side = 3, 
      at = 0.025,
      line = line_top,
      cex=cex_txt,
      outer = TRUE)

par(mfrow = c(1,2),
    oma = c(0,2,2,1),
    mar = c(3,3,0.5,0.5)#c(2,4,3,1)
    )

## MA
plot(raster_sharpnose_MA[[layer]], bty = "n")

sp::plot(gulf.shape, add= T,
         xlab = "", ylab = "",
         xlim = my_xlim, ylim = my_ylim,
         #xaxt = "n", yaxt = "n",
         col = "gray",
         bty="n")

points(startlat~startlon, 
       data = df_2_lst$sharpnose_Male_Adult,
       xlim = my_xlim, ylim = my_ylim,
       pch = pch_pts,
       col = "black",
       #bg="black",
       cex = cex_pts)

## MJ
plot(raster_sharpnose_MJ[[layer]], bty = "n")

sp::plot(gulf.shape, add= T,
         xlab = "", ylab = "",
         xlim = my_xlim, ylim = my_ylim,
         #xaxt = "n", yaxt = "n",
         col = "gray",
         bty="n")

points(startlat~startlon, 
       data = df_2_lst$sharpnose_Male_Juvenile,
       xlim = my_xlim, ylim = my_ylim,
       pch = pch_pts,
       col = "black",
       #bg="black",
       cex = cex_pts)



mtext("Male",
      side = 2,
      at=2/4,
      outer = TRUE,
      cex = cex_txt)
```


#### Layer 2 (Strata 2 Abundance)

Darker/green color reflects higher CPUE. White areas are areas outside sampling region where no predictions where made. 

```{r, message=FALSE, fig.width=14}
layer <- 2

par(mfrow = c(1,2),
    oma = c(0,2,2,1),
    mar = c(3,3,0.5,0.5)#c(2,4,3,1)
    )

## FA
plot(raster_sharpnose_FA[[layer]])

sp::plot(gulf.shape, add= T,
         xlab = "", ylab = "",
         xlim = my_xlim, ylim = my_ylim,
         #xaxt = "n", yaxt = "n",
         col = "gray",
         bty="n")

points(startlat~startlon, 
       data = df_2_lst$sharpnose_Female_Adult,
       xlim = my_xlim, ylim = my_ylim,
       pch = pch_pts,
       col = "black",
       #bg="black",
       cex = cex_pts)

## FJ
plot(raster_sharpnose_FJ[[layer]], bty = "n")

sp::plot(gulf.shape, add= T,
         xlab = "", ylab = "",
         xlim = my_xlim, ylim = my_ylim,
         #xaxt = "n", yaxt = "n",
         col = "gray",
         bty="n")

points(startlat~startlon, 
       data = df_2_lst$sharpnose_Female_Juvenile,
       xlim = my_xlim, ylim = my_ylim,
       pch = pch_pts,
       col = "black",
       #bg="black",
       cex = cex_pts)

mtext("Adult",
      side = 3,
      at=1/4,
      outer = TRUE,
      cex = cex_txt,
      line = line_top)

mtext("Juvenile",
      side = 3,
      at=3/4,
      outer = TRUE,
      cex = cex_txt,
      line = line_top)

mtext("Female",
      side = 2,
      at=2/4,
      outer = TRUE,
      cex = cex_txt)

mtext("(c)",
      side = 3, 
      at = 0.025,
      line = line_top,
      cex=cex_txt,
      outer = TRUE)

par(mfrow = c(1,2),
    oma = c(0,2,2,1),
    mar = c(3,3,0.5,0.5)#c(2,4,3,1)
    )

## MA
plot(raster_sharpnose_MA[[layer]], bty = "n")

sp::plot(gulf.shape, add= T,
         xlab = "", ylab = "",
         xlim = my_xlim, ylim = my_ylim,
         #xaxt = "n", yaxt = "n",
         col = "gray",
         bty="n")

points(startlat~startlon, 
       data = df_2_lst$sharpnose_Male_Adult,
       xlim = my_xlim, ylim = my_ylim,
       pch = pch_pts,
       col = "black",
       #bg="black",
       cex = cex_pts)

## MJ
plot(raster_sharpnose_MJ[[layer]], bty = "n")

sp::plot(gulf.shape, add= T,
         xlab = "", ylab = "",
         xlim = my_xlim, ylim = my_ylim,
         #xaxt = "n", yaxt = "n",
         col = "gray",
         bty="n")

points(startlat~startlon, 
       data = df_2_lst$sharpnose_Male_Juvenile,
       xlim = my_xlim, ylim = my_ylim,
       pch = pch_pts,
       col = "black",
       #bg="black",
       cex = cex_pts)

mtext("Male",
      side = 2,
      at=2/4,
      outer = TRUE,
      cex = cex_txt)
```



## Blacknose

### Table 3 

  Top 3 models fit for each strata, sex and maturity of Blacknose sharks ranked by AIC. $95\% ~ Confidence set$ gives to number of models with cumulative AIC Wieght less than 0.95. Delta AIV less than 4 gives the number of models selected with an AIC less than four.   

```{r}
table3 <- read_csv_fn("data/clean-data/table-data/Table3.csv", proj) #%>%

table3$AIC <- round(table3$AIC, 3)  
table3$delta.AIC <- round(table3$delta.AIC, 3) 
table3$AIC.Weight <- round(table3$AIC.Weight, 3) 
table3$Cumulative.Weight <- round(table3$Cumulative.Weight, 3) 
  
names(table3) <- c("Species", "Strata", "Sex", "Maturity", "Model Formula", "No. Of Parameters", "AIC", "delta AIC", 
                   "AIC Weight", "Cumulative Weight", "Deviance Explained", "95% Confidence set (n)", "delta AIC < 4 (n)")

bn_tbl3 <- subset(table3, Species == "Blacknose")
rownames(bn_tbl3) <- NULL
```
```{r}
bn_tbl3 %>%
  kable() %>%
  kable_styling("striped", 
                full_width = TRUE, 
                position = "left"
                ) %>%
  column_spec(5, width_min = "10cm") %>%
  collapse_rows(columns = c(1:4,12,13), valign = "middle")
```

### Table 4 

The relative importance of each variable in best subset of models ($\Delta AIC < 4$) for each strata, sex and maturity for Blacknose sharks.  

```{r}
table4 <- read_csv_fn("data/clean-data/table-data/Table4.csv", proj) %>%
  mutate(Depth = round(Depth, 3), Temperature = round(Temperature,3), Turbidity = round(Turbidity,3), Oxygen = round(Oxygen,3), 
         Salinity = round(Salinity,3), Distance.to.Shore = round(Distance.to.Shore,3), Bottom.Type = round(Bottom.Type,3))

names(table4) <- c("Species", "Strata", "Sex", "Maturity", "Depth", "Temperature", "Turbidity", "Oxygen", "Salinity", "Distance to Shore", "Bottom Type")

bn_table4 <- subset(table4, Species =="Blacknose")
rownames(bn_table4) <- NULL
```
```{r}
bn_table4 %>%
  kable() %>%
  kable_styling("striped",
                full_width = F, 
                position = "center",
                font_size = 14) %>%
  collapse_rows(columns = c(1:3), valign = "middle")
```

### Figure 2 

Smooths for best fit models for each stata, sex and maturity of Blacknose sharks. X-axis is the range of the explanatory variable given at the top of each column. Y-axis represents the magnitude of the predictor variables effect of the response. Shaded areas represent the $95 \% CI$.

#### Strata 1 $P(Occurrence)$

```{r, include=FALSE}
filenames_s1 <- list.files("output/output_GAM/best/blacknose/strat1",
                           pattern="*.rda", full.names=TRUE)

lapply(filenames_s1, load, .GlobalEnv)


rm( filenames_s1 )

bn_mod_s1 = list(    # Blacknose
  bn_s1_FA_best = bn_s1_FA_best, ## bn s1
  bn_s1_FJ_best = bn_s1_FJ_best,
  bn_s1_MA_best = bn_s1_MA_best,
  bn_s1_MJ_best = bn_s1_MJ_best
  )
                
```
```{r, include=FALSE}
bn_row_1 <- c( 1, 2, 0, 3, 4, 5, 6)
bn_row_2 <- c( 7, 8, 0, 0, 0, 9, 10)
bn_row_3 <- c( 11, 12, 13, 14, 15, 16, 17)
bn_row_4 <-  c( 18, 19, 0, 20, 0, 21, 22)

(bn_mat_s1 <- matrix(c(bn_row_1, bn_row_2, bn_row_3, bn_row_4),
                  nrow = 4, ncol = 7, byrow = TRUE) )
bn.lay.s1 <- layout( bn_mat_s1 )
layout.show( bn.lay.s1 )
                   
```
```{r, include=FALSE}
cex_txt <- 2
cex_lab <- 2.5
cex_axis <- 2.25
my_lwd <- 2.25
y_line <- 1.5
x_line <- 0

letter_line <- 0
letter_at <- 0

sleep_time <- 0.01
```
```{r, include=TRUE, fig.width=18, fig.height=14} 

  par(oma = c(1.5, 4.25, 2.5, 1), # two rows of text at the outer left and bottom margin
    mar = c(1, 1, 1, 1), # space for one row of text at ticks and to separate plots
    mgp = c(1.75, 0.75, 0))
  
  layout( bn_mat_s1 )


for(j in 1:length( bn_mod_s1 ) ){ ### loop through Sex, and Maturity level of mod_lst_s1 
      
      for(k in 2:8){ ## Loop through specific variables in each level of sex and maturity for specific species
    
    plot(bn_mod_s1[[j]], select = k,
         scale = 0,
         shade = TRUE,
         xlab = "", ylab = "",
         main = "",
         lwd= my_lwd, 
         cex.axis = cex_axis, 
         cex.lab = cex_lab, 
         bty = "n")
    
    abline( h = 0, col = "blue", lty = 3)  
    
    Sys.sleep(sleep_time)
    
    }
      
    }
  
  ### Y labels
    mtext("Female Adult ",
        side = 2, 
        at = 0.875,
        line = y_line,
        cex = cex_txt, 
        outer = TRUE)
  
    mtext("Female Juvenile",
        side = 2,
        at = 0.625,
        line = y_line,
        cex = cex_txt,
        outer = TRUE)
    
      mtext("Male Adult",
        side = 2, 
        at = 0.375,
        line = y_line,
        cex = cex_txt,
        outer = TRUE)
      
        mtext("Male Juvenile",
        side = 2, 
        at = 0.125,
        line = y_line,
        cex = cex_txt,
        outer = TRUE)
  ### X Labels
        mtext("Depth",
        side = 3, 
        at = 1/14,
        line = x_line,
        cex = cex_txt,
        outer = TRUE)
        
        mtext("Temp",
        side = 3, 
        at = 3/14,
        line = x_line,
        cex = cex_txt,
        outer = TRUE)
        
        mtext("Turb",
        side = 3, 
        at = 5/14,
        line = x_line,
        cex = cex_txt,
        outer = TRUE)
        
        mtext("Oxy",
        side = 3, 
        at = 1/2,
        line = x_line,
        cex = cex_txt,
        outer = TRUE)
        
        mtext("Sal",
        side = 3, 
        at = 9/14,
        line = x_line,
        cex = cex_txt,
        outer = TRUE)
        
        mtext("Distance",
        side = 3, 
        at = 11/14,
        line = x_line,
        cex = cex_txt,
        outer = TRUE)
       
         mtext("Year",
        side = 3, 
        at = 13/14,
        line = x_line,
        cex = cex_txt,
        outer = TRUE)
        
         ### Figure letter
        mtext("(a)",
        side = 3, 
        at = letter_at,
        line = letter_line,
        cex = cex_txt,
        outer = TRUE) 
```
```{r, include=FALSE}
rm(bn_mod_s1, bn_s1_FA_best, bn_s1_FJ_best, bn_s1_MA_best, bn_s1_MJ_best, bn_mat_s1, lay_mat_s1, j, k,
   bn_row_1, bn_row_2, bn_row_3, bn_row_4, bn.lay.s1)
rm(cex_txt, cex_lab, cex_axis, my_lwd, y_line, x_line, letter_line, letter_at, sleep_time)
```



#### strata 2 Abundance

```{r, include=FALSE}
filenames_s2 <- list.files("output/output_GAM/best/blacknose/strat2",
                           pattern="*.rda", full.names=TRUE)

lapply(filenames_s2, load, .GlobalEnv)


rm( filenames_s2 )

bn_mod_s2 = list(    # Blacknose
  bn_s2_FA_best = bn_s2_FA_best, ## bn s1
  bn_s2_FJ_best = bn_s2_FJ_best,
  bn_s2_MA_best = bn_s2_MA_best,
  bn_s2_MJ_best = bn_s2_MJ_best
  )
                
```
```{r, include=FALSE}
bn_row_5 <- c( 0, 1, 0, 2, 0, 0, 3)
bn_row_6 <- c( 0, 4, 0, 0, 5, 6, 7)
bn_row_7 <- c( 8, 0, 0, 9, 10, 11, 12)
bn_row_8 <- c( 0, 0, 13, 14, 15, 0, 16)

(bn_mat_s2 <- matrix(c(bn_row_5, bn_row_6, bn_row_7, bn_row_8),
                  nrow = 4, ncol = 7, byrow = TRUE) )

bn.lay.s2 <- layout( bn_mat_s2 )
layout.show( bn.lay.s2 )
```
```{r, include=FALSE}
cex_txt <- 2
cex_lab <- 2.5
cex_axis <- 2.25
my_lwd <- 2.25
y_line <- 1.5
x_line <- 0

letter_line <- 0
letter_at <- 0

sleep_time <- 0.01
```
```{r, include=TRUE, fig.width=18, fig.height=14}
  par(oma = c(1.5, 4.25, 2.5, 1), # two rows of text at the outer left and bottom margin
    mar = c(1, 1, 1, 1), # space for one row of text at ticks and to separate plots
    mgp = c(1.75, 0.75, 0))
  
  layout( bn_mat_s2 )
  
for(j in 1:length(bn_mod_s2)){ ## Loop through Sex and maturity levels for a species
  
  for(k in 2:8){ ## loop through explanatory variables in one level of sex and maturity for a species
    
    plot(bn_mod_s2[[j]], select = k,
         scale = 0,
         shade = TRUE,
         xlab = "", ylab = "",
         main = "",
         lwd= my_lwd, 
         cex.axis = cex_axis, 
         cex.lab = cex_lab, 
         bty = "n")
    
    abline( h = 0, col = "blue", lty = 3)    
    
  }   
  
} 
  
  
  ### Y labels
    mtext("Female Adult ",
        side = 2, 
        at = 0.875,
        line = y_line,
        cex = cex_txt, 
        outer = TRUE)
  
    mtext("Female Juvenile",
        side = 2,
        at = 0.625,
        line = y_line,
        cex = cex_txt,
        outer = TRUE)
    
      mtext("Male Adult",
        side = 2, 
        at = 0.375,
        line = y_line,
        cex = cex_txt,
        outer = TRUE)
      
        mtext("Male Juvenile",
        side = 2, 
        at = 0.125,
        line = y_line,
        cex = cex_txt,
        outer = TRUE)
  ### X Labels
        mtext("Depth",
        side = 3, 
        at = 1/14,
        line = x_line,
        cex = cex_txt,
        outer = TRUE)
        
        mtext("Temp",
        side = 3, 
        at = 3/14,
        line = x_line,
        cex = cex_txt,
        outer = TRUE)
        
        mtext("Turb",
        side = 3, 
        at = 5/14,
        line = x_line,
        cex = cex_txt,
        outer = TRUE)
        
        mtext("Oxy",
        side = 3, 
        at = 1/2,
        line = x_line,
        cex = cex_txt,
        outer = TRUE)
        
        mtext("Sal",
        side = 3, 
        at = 9/14,
        line = x_line,
        cex = cex_txt,
        outer = TRUE)
        
        mtext("Distance",
        side = 3, 
        at = 11/14,
        line = x_line,
        cex = cex_txt,
        outer = TRUE)
       
         mtext("Year",
        side = 3, 
        at = 13/14,
        line = x_line,
        cex = cex_txt,
        outer = TRUE)
        
         ### Figure letter
        mtext(paste0("(b)"),
        side = 3, 
        at = letter_at,
        line = letter_line,
        cex = cex_txt,
        outer = TRUE) 
```
```{r, include=FALSE}
rm(bn_mod_s2, bn_s2_FA_best, bn_s2_FJ_best, bn_s2_MA_best, bn_s2_MJ_best, lay_mat_s2, bn_mat_s2, j, k,
   bn_row_5, bn_row_6, bn_row_7, bn_row_8, bn.lay.s2)
rm(cex_txt, cex_lab, cex_axis, my_lwd, y_line, x_line, letter_line, letter_at, sleep_time)
```

#### Bottype

```{r, include=FALSE}
load("output/output_GAM/best/blacknose/strat2/bn_s2_FA_best.rda")
load("output/output_GAM/best/blacknose/strat2/bn_s2_MA_best.rda")

bn_mod_lst = list( 
  bn_s2_FA_best = bn_s2_FA_best,
  bn_s2_MA_best = bn_s2_MA_best
  )

rm(bn_s2_FA_best, bn_s2_MA_best)
```
```{r, fig.width=14}
par(mfrow = c(1,2))
plot(bn_mod_lst$bn_s2_FA_best, all.terms = TRUE, select = 5, scale = 0, se = TRUE, bty = "n")
mtext("Adult Female Blacknose Strata 2", side = 3, cex = 2)


plot(bn_mod_lst$bn_s2_MA_best, all.terms = TRUE, select = 7, scale = 0, se = TRUE, bty = "n")
mtext("Adult Male Blacknose Strata 2", side = 3, cex = 2)

```


### Figure 3 
```{r, include=FALSE}
### Figure Options

cex_pts <- 2
pch_pts <- "."

line_top <- 0

cex_txt <- 2.25

my_xlim = c(-100,-80)
my_ylim = c(22,33)

```
#### Layer 3 ($P(Occurrence) \times Abundance$)

Darker/green color reflects higher CPUE. White areas are areas outside sampling region where no predictions where made. 

```{r, fig.width=14}
layer <- 3

par(mfrow = c(1,2),
    oma = c(0,2,2,1),
    mar = c(3,3,0.5,0.5)#c(2,4,3,1)
)

## FA
plot(raster_blacknose_FA[[layer]])

sp::plot(gulf.shape, add= T,
         xlab = "", ylab = "",
         xlim = my_xlim, ylim = my_ylim,
         #xaxt = "n", yaxt = "n",
         col = "gray",
         bty="n")

points(startlat~startlon, 
       data = df_2_lst$blacknose_Female_Adult,
       xlim = my_xlim, ylim = my_ylim,
       pch = pch_pts,
       col = "black",
       #bg="black",
       cex = cex_pts)

## FJ
plot(raster_blacknose_FJ[[layer]], bty = "n")

sp::plot(gulf.shape, add= T,
         xlab = "", ylab = "",
         xlim = my_xlim, ylim = my_ylim,
         #xaxt = "n", yaxt = "n",
         col = "gray",
         bty="n")

points(startlat~startlon, 
       data = df_2_lst$blacknose_Female_Juvenile,
       xlim = my_xlim, ylim = my_ylim,
       pch = pch_pts,
       col = "black",
       #bg="black",
       cex = cex_pts)

mtext("Adult",
      side = 3,
      at=1/4,
      outer = TRUE,
      cex = cex_txt,
      line = line_top)

mtext("Juvenile",
      side = 3,
      at=3/4,
      outer = TRUE,
      cex = cex_txt,
      line = line_top)

mtext("Female",
      side = 2,
      at=2/4,
      outer = TRUE,
      cex = cex_txt)

mtext("(a)",
      side = 3, 
      at = 0.025,
      line = line_top,
      cex=cex_txt,
      outer = TRUE)

par(mfrow = c(1,2),
    oma = c(0,2,2,1),
    mar = c(3,3,0.5,0.5)#c(2,4,3,1)
    )

## MA
plot(raster_blacknose_MA[[layer]], bty = "n")

sp::plot(gulf.shape, add= T,
         xlab = "", ylab = "",
         xlim = my_xlim, ylim = my_ylim,
         #xaxt = "n", yaxt = "n",
         col = "gray",
         bty="n")

points(startlat~startlon, 
       data = df_2_lst$blacknose_Male_Adult,
       xlim = my_xlim, ylim = my_ylim,
       pch = pch_pts,
       col = "black",
       #bg="black",
       cex = cex_pts)

## MJ
plot(raster_blacknose_MJ[[layer]], bty = "n")

sp::plot(gulf.shape, add= T,
         xlab = "", ylab = "",
         xlim = my_xlim, ylim = my_ylim,
         #xaxt = "n", yaxt = "n",
         col = "gray",
         bty="n")

points(startlat~startlon, 
       data = df_2_lst$blacknose_Male_Juvenile,
       xlim = my_xlim, ylim = my_ylim,
       pch = pch_pts,
       col = "black",
       #bg="black",
       cex = cex_pts)

mtext("Male",
      side = 2,
      at=2/4,
      outer = TRUE,
      cex = cex_txt)
```

#### Layer 1 (Strata 1 $P(Occurrence)$)

Darker/green color reflects higher probability of occurance. White areas are areas outside sampling region where no predictions where made. 

```{r, fig.width=14}
layer <- 1

par(mfrow = c(1,2),
    oma = c(0,2,2,1),
    mar = c(3,3,0.5,0.5)#c(2,4,3,1)
)

## FA
plot(raster_blacknose_FA[[layer]])

sp::plot(gulf.shape, add= T,
         xlab = "", ylab = "",
         xlim = my_xlim, ylim = my_ylim,
         #xaxt = "n", yaxt = "n",
         col = "gray",
         bty="n")

points(startlat~startlon, 
       data = df_2_lst$blacknose_Female_Adult,
       xlim = my_xlim, ylim = my_ylim,
       pch = pch_pts,
       col = "black",
       #bg="black",
       cex = cex_pts)

## FJ
plot(raster_blacknose_FJ[[layer]], bty = "n")

sp::plot(gulf.shape, add= T,
         xlab = "", ylab = "",
         xlim = my_xlim, ylim = my_ylim,
         #xaxt = "n", yaxt = "n",
         col = "gray",
         bty="n")

points(startlat~startlon, 
       data = df_2_lst$blacknose_Female_Juvenile,
       xlim = my_xlim, ylim = my_ylim,
       pch = pch_pts,
       col = "black",
       #bg="black",
       cex = cex_pts)

mtext("Adult",
      side = 3,
      at=1/4,
      outer = TRUE,
      cex = cex_txt,
      line = line_top)

mtext("Juvenile",
      side = 3,
      at=3/4,
      outer = TRUE,
      cex = cex_txt,
      line = line_top)

mtext("Female",
      side = 2,
      at=2/4,
      outer = TRUE,
      cex = cex_txt)

mtext("(a)",
      side = 3, 
      at = 0.025,
      line = line_top,
      cex=cex_txt,
      outer = TRUE)

par(mfrow = c(1,2),
    oma = c(0,2,2,1),
    mar = c(3,3,0.5,0.5)#c(2,4,3,1)
    )

## MA
plot(raster_blacknose_MA[[layer]], bty = "n")

sp::plot(gulf.shape, add= T,
         xlab = "", ylab = "",
         xlim = my_xlim, ylim = my_ylim,
         #xaxt = "n", yaxt = "n",
         col = "gray",
         bty="n")

points(startlat~startlon, 
       data = df_2_lst$blacknose_Male_Adult,
       xlim = my_xlim, ylim = my_ylim,
       pch = pch_pts,
       col = "black",
       #bg="black",
       cex = cex_pts)

## MJ
plot(raster_blacknose_MJ[[layer]], bty = "n")

sp::plot(gulf.shape, add= T,
         xlab = "", ylab = "",
         xlim = my_xlim, ylim = my_ylim,
         #xaxt = "n", yaxt = "n",
         col = "gray",
         bty="n")

points(startlat~startlon, 
       data = df_2_lst$blacknose_Male_Juvenile,
       xlim = my_xlim, ylim = my_ylim,
       pch = pch_pts,
       col = "black",
       #bg="black",
       cex = cex_pts)

mtext("Male",
      side = 2,
      at=2/4,
      outer = TRUE,
      cex = cex_txt)


```

#### Layer 2 (Strata 2 Abundance)

Estimated CPUE multiplied by probability of occurance. Darker/green color reflects higher CPUE. White areas are areas outside sampling region where no predictions where made. 

```{r, fig.width=14}
layer <- 2

par(mfrow = c(1,2),
    oma = c(0,2,2,1),
    mar = c(3,3,0.5,0.5)#c(2,4,3,1)
)

## FA
plot(raster_blacknose_FA[[layer]])

sp::plot(gulf.shape, add= T,
         xlab = "", ylab = "",
         xlim = my_xlim, ylim = my_ylim,
         #xaxt = "n", yaxt = "n",
         col = "gray",
         bty="n")

points(startlat~startlon, 
       data = df_2_lst$blacknose_Female_Adult,
       xlim = my_xlim, ylim = my_ylim,
       pch = pch_pts,
       col = "black",
       #bg="black",
       cex = cex_pts)

## FJ
plot(raster_blacknose_FJ[[layer]], bty = "n")

sp::plot(gulf.shape, add= T,
         xlab = "", ylab = "",
         xlim = my_xlim, ylim = my_ylim,
         #xaxt = "n", yaxt = "n",
         col = "gray",
         bty="n")

points(startlat~startlon, 
       data = df_2_lst$blacknose_Female_Juvenile,
       xlim = my_xlim, ylim = my_ylim,
       pch = pch_pts,
       col = "black",
       #bg="black",
       cex = cex_pts)

mtext("Adult",
      side = 3,
      at=1/4,
      outer = TRUE,
      cex = cex_txt,
      line = line_top)

mtext("Juvenile",
      side = 3,
      at=3/4,
      outer = TRUE,
      cex = cex_txt,
      line = line_top)

mtext("Female",
      side = 2,
      at=2/4,
      outer = TRUE,
      cex = cex_txt)

mtext("(a)",
      side = 3, 
      at = 0.025,
      line = line_top,
      cex=cex_txt,
      outer = TRUE)

par(mfrow = c(1,2),
    oma = c(0,2,2,1),
    mar = c(3,3,0.5,0.5)#c(2,4,3,1)
    )

## MA
plot(raster_blacknose_MA[[layer]], bty = "n")

sp::plot(gulf.shape, add= T,
         xlab = "", ylab = "",
         xlim = my_xlim, ylim = my_ylim,
         #xaxt = "n", yaxt = "n",
         col = "gray",
         bty="n")

points(startlat~startlon, 
       data = df_2_lst$blacknose_Male_Adult,
       xlim = my_xlim, ylim = my_ylim,
       pch = pch_pts,
       col = "black",
       #bg="black",
       cex = cex_pts)

## MJ
plot(raster_blacknose_MJ[[layer]], bty = "n")

sp::plot(gulf.shape, add= T,
         xlab = "", ylab = "",
         xlim = my_xlim, ylim = my_ylim,
         #xaxt = "n", yaxt = "n",
         col = "gray",
         bty="n")

points(startlat~startlon, 
       data = df_2_lst$blacknose_Male_Juvenile,
       xlim = my_xlim, ylim = my_ylim,
       pch = pch_pts,
       col = "black",
       #bg="black",
       cex = cex_pts)

mtext("Male",
      side = 2,
      at=2/4,
      outer = TRUE,
      cex = cex_txt)
```


## Blacktip

### Table 3 

  Top 3 models fit for each strata, sex and maturity of Blacktip sharks ranked by AIC. $95\% ~ Confidence set$ gives to number of models with cumulative AIC Wieght less than 0.95. Delta AIV less than 4 gives the number of models selected with an AIC less than four.

```{r}
table3 <- read_csv_fn("data/clean-data/table-data/Table3.csv", proj) #%>%

table3$AIC <- round(table3$AIC, 3)  
table3$delta.AIC <- round(table3$delta.AIC, 3) 
table3$AIC.Weight <- round(table3$AIC.Weight, 3) 
table3$Cumulative.Weight <- round(table3$Cumulative.Weight, 3) 
  
names(table3) <- c("Species", "Strata", "Sex", "Maturity", "Model Formula", "No. Of Parameters", "AIC", "delta AIC", 
                   "AIC Weight", "Cumulative Weight", "Deviance Explained", "95% Confidence set (n)", "delta AIC < 4 (n)")

bt_tbl3 <- subset(table3, Species == "Blacktip")
rownames(bt_tbl3) <- NULL
```
```{r}
bt_tbl3 %>%
  kable() %>%
  kable_styling("striped", 
                full_width = TRUE, 
                position = "left"
                ) %>%
  column_spec(5, width_min = "10cm") %>%
  collapse_rows(columns = c(1:4,12,13), valign = "middle")
```


### Table 4 

The relative importance of each variable in best subset of models ($\Delta AIC < 4$) for each strata, sex and maturity for Blacktip sharks.  

```{r}
table4 <- read_csv_fn("data/clean-data/table-data/Table4.csv", proj) %>%
  mutate(Depth = round(Depth, 3), Temperature = round(Temperature,3), Turbidity = round(Turbidity,3), Oxygen = round(Oxygen,3), 
         Salinity = round(Salinity,3), Distance.to.Shore = round(Distance.to.Shore,3), Bottom.Type = round(Bottom.Type,3))

names(table4) <- c("Species", "Strata", "Sex", "Maturity", "Depth", "Temperature", "Turbidity", "Oxygen", "Salinity", "Distance to Shore", "Bottom Type")

bt_table4 <- subset(table4, Species =="Blacktip")
rownames(bt_table4) <- NULL
```
```{r}
bt_table4 %>%
  kable() %>%
  kable_styling("striped",
                full_width = F, 
                position = "center",
                font_size = 14) %>%
  collapse_rows(columns = c(1:3), valign = "middle")
```



### Figure 2 

Smooths for best fit models for each stata, sex and maturity of Blacktip sharks. X-axis is the range of the explanatory variable given at the top of each column. Y-axis represents the magnitude of the predictor variables effect of the response. Shaded areas represent the $95 \% CI$.  

#### Strata 1 $P(Occurrence)$

```{r, include=FALSE}
filenames_s1 <- list.files("output/output_GAM/best/blacktip/strat1",
                           pattern="*.rda", full.names=TRUE)

lapply(filenames_s1, load, .GlobalEnv)


rm( filenames_s1 )

bt_mod_s1 = list(    # Blacktip
  bt_s1_FA_best = bt_s1_FA_best, ## bt s1
  bt_s1_FJ_best = bt_s1_FJ_best,
  bt_s1_MA_best = bt_s1_MA_best,
  bt_s1_MJ_best = bt_s1_MJ_best
  )
                
```
```{r, include=FALSE}
bt_row_1 <-   c( 0, 1, 2, 3, 4, 5, 6)
bt_row_2 <- c( 7, 8, 9, 10, 0, 11, 12)
bt_row_3 <- c( 13, 14, 15, 16, 0, 17, 18)
bt_row_4 <- c( 0, 19, 20, 21, 22, 0, 23)

(bt_mat_s1 <- matrix(c(bt_row_1, bt_row_2, bt_row_3, bt_row_4),
                  nrow = 4, ncol = 7, byrow = TRUE) )
bt.lay.s1 <- layout( bt_mat_s1 )
layout.show( bt.lay.s1 )
                   
```
```{r, include=FALSE}
cex_txt <- 2
cex_lab <- 2.5
cex_axis <- 2.25
my_lwd <- 2.25
y_line <- 1.5
x_line <- 0

letter_line <- 0
letter_at <- 0

sleep_time <- 0.01
```

```{r, include=TRUE, fig.width=18, fig.height=14} 

  par(oma = c(1.5, 4.25, 2.5, 1), # two rows of text at the outer left and bottom margin
    mar = c(1, 1, 1, 1), # space for one row of text at ticks and to separate plots
    mgp = c(1.75, 0.75, 0))
  
  layout( bt_mat_s1 )


for(j in 1:length( bt_mod_s1 ) ){ ### loop through Sex, and Maturity level of mod_lst_s1 
      
      for(k in 2:8){ ## Loop through specific variables in each level of sex and maturity for specific species
    
    plot(bt_mod_s1[[j]], select = k,
         scale = 0,
         shade = TRUE,
         xlab = "", ylab = "",
         main = "",
         lwd= my_lwd, 
         cex.axis = cex_axis, 
         cex.lab = cex_lab, 
         bty = "n")
    
    abline( h = 0, col = "blue", lty = 3)  
    
    Sys.sleep(sleep_time)
    
    }
      
    }
  
  ### Y labels
    mtext("Female Adult ",
        side = 2, 
        at = 0.875,
        line = y_line,
        cex = cex_txt, 
        outer = TRUE)
  
    mtext("Female Juvenile",
        side = 2,
        at = 0.625,
        line = y_line,
        cex = cex_txt,
        outer = TRUE)
    
      mtext("Male Adult",
        side = 2, 
        at = 0.375,
        line = y_line,
        cex = cex_txt,
        outer = TRUE)
      
        mtext("Male Juvenile",
        side = 2, 
        at = 0.125,
        line = y_line,
        cex = cex_txt,
        outer = TRUE)
  ### X Labels
        mtext("Depth",
        side = 3, 
        at = 1/14,
        line = x_line,
        cex = cex_txt,
        outer = TRUE)
        
        mtext("Temp",
        side = 3, 
        at = 3/14,
        line = x_line,
        cex = cex_txt,
        outer = TRUE)
        
        mtext("Turb",
        side = 3, 
        at = 5/14,
        line = x_line,
        cex = cex_txt,
        outer = TRUE)
        
        mtext("Oxy",
        side = 3, 
        at = 1/2,
        line = x_line,
        cex = cex_txt,
        outer = TRUE)
        
        mtext("Sal",
        side = 3, 
        at = 9/14,
        line = x_line,
        cex = cex_txt,
        outer = TRUE)
        
        mtext("Distance",
        side = 3, 
        at = 11/14,
        line = x_line,
        cex = cex_txt,
        outer = TRUE)
       
         mtext("Year",
        side = 3, 
        at = 13/14,
        line = x_line,
        cex = cex_txt,
        outer = TRUE)
        
         ### Figure letter
        mtext("(c)",
        side = 3, 
        at = letter_at,
        line = letter_line,
        cex = cex_txt,
        outer = TRUE) 
```
```{r, include=FALSE}
rm(bt_mod_s1, bt_s1_FA_best, bt_s1_FJ_best, bt_s1_MA_best, bt_s1_MJ_best, bt_mat_s1, lay_mat_s1, j, k,
   bt_row_1, bt_row_2, bt_row_3, bt_row_4, bt.lay.s1)
rm(cex_txt, cex_lab, cex_axis, my_lwd, y_line, x_line, letter_line, letter_at, sleep_time)
```



#### strata 2 Abundance

```{r, include=FALSE}
filenames_s2 <- list.files("output/output_GAM/best/blacktip/strat2",
                           pattern="*.rda", full.names=TRUE)

lapply(filenames_s2, load, .GlobalEnv)


rm( filenames_s2 )

bt_mod_s2 = list(    # Blacknose
  bt_s2_FA_best = bt_s2_FA_best, ## bn s1
  bt_s2_FJ_best = bt_s2_FJ_best,
  bt_s2_MA_best = bt_s2_MA_best,
  bt_s2_MJ_best = bt_s2_MJ_best
  )
                
```
```{r, include=FALSE}
bt_row_5 <- c( 0, 0, 0, 1, 2, 0, 3)
bt_row_6 <- c( 4, 5, 6, 7, 8, 0, 9)
bt_row_7 <- c( 10, 0, 0, 0, 11, 12, 13)
bt_row_8 <- c( 14, 0, 15, 16, 17, 0, 18)

(bt_mat_s2 <- matrix(c(bt_row_5, bt_row_6, bt_row_7, bt_row_8),
                  nrow = 4, ncol = 7, byrow = TRUE) )

bt.lay.s2 <- layout( bt_mat_s2 )
layout.show( bt.lay.s2 )
```
```{r, include=FALSE}
cex_txt <- 2
cex_lab <- 2.5
cex_axis <- 2.25
my_lwd <- 2.25
y_line <- 1.5
x_line <- 0

letter_line <- 0
letter_at <- 0

sleep_time <- 0.01
```

```{r, include=TRUE, fig.width=18, fig.height=14}
  par(oma = c(1.5, 4.25, 2.5, 1), # two rows of text at the outer left and bottom margin
    mar = c(1, 1, 1, 1), # space for one row of text at ticks and to separate plots
    mgp = c(1.75, 0.75, 0))
  
  layout( bt_mat_s2 )
  
for(j in 1:length(bt_mod_s2)){ ## Loop through Sex and maturity levels for a species
  
  for(k in 2:8){ ## loop through explanatory variables in one level of sex and maturity for a species
    
    plot(bt_mod_s2[[j]], select = k,
         scale = 0,
         shade = TRUE,
         xlab = "", ylab = "",
         main = "",
         lwd= my_lwd, 
         cex.axis = cex_axis, 
         cex.lab = cex_lab, 
         bty = "n")
    
    abline( h = 0, col = "blue", lty = 3)    
    
  }   
  
} 
  
  
  ### Y labels
    mtext("Female Adult ",
        side = 2, 
        at = 0.875,
        line = y_line,
        cex = cex_txt, 
        outer = TRUE)
  
    mtext("Female Juvenile",
        side = 2,
        at = 0.625,
        line = y_line,
        cex = cex_txt,
        outer = TRUE)
    
      mtext("Male Adult",
        side = 2, 
        at = 0.375,
        line = y_line,
        cex = cex_txt,
        outer = TRUE)
      
        mtext("Male Juvenile",
        side = 2, 
        at = 0.125,
        line = y_line,
        cex = cex_txt,
        outer = TRUE)
  ### X Labels
        mtext("Depth",
        side = 3, 
        at = 1/14,
        line = x_line,
        cex = cex_txt,
        outer = TRUE)
        
        mtext("Temp",
        side = 3, 
        at = 3/14,
        line = x_line,
        cex = cex_txt,
        outer = TRUE)
        
        mtext("Turb",
        side = 3, 
        at = 5/14,
        line = x_line,
        cex = cex_txt,
        outer = TRUE)
        
        mtext("Oxy",
        side = 3, 
        at = 1/2,
        line = x_line,
        cex = cex_txt,
        outer = TRUE)
        
        mtext("Sal",
        side = 3, 
        at = 9/14,
        line = x_line,
        cex = cex_txt,
        outer = TRUE)
        
        mtext("Distance",
        side = 3, 
        at = 11/14,
        line = x_line,
        cex = cex_txt,
        outer = TRUE)
       
         mtext("Year",
        side = 3, 
        at = 13/14,
        line = x_line,
        cex = cex_txt,
        outer = TRUE)
        
         ### Figure letter
        mtext(paste0("(d)"),
        side = 3, 
        at = letter_at,
        line = letter_line,
        cex = cex_txt,
        outer = TRUE) 
```
```{r, include=FALSE}
rm(bt_mod_s2, bt_s2_FA_best, bt_s2_FJ_best, bt_s2_MA_best, bt_s2_MJ_best, lay_mat_s2, bt_mat_s2, j, k,
   bt_row_5, bt_row_6, bt_row_7, bt_row_8, bt.lay.s2)
rm(cex_txt, cex_lab, cex_axis, my_lwd, y_line, x_line, letter_line, letter_at, sleep_time)
```

#### Bottype

```{r, include=FALSE}
load("output/output_GAM/best/blacktip/strat1/bt_s1_MA_best.rda")
load("output/output_GAM/best/blacktip/strat1/bt_s1_MJ_best.rda")

bt_mod_lst = list(    # Sharpnose
  bt_s1_MA_best = bt_s1_MA_best,
  bt_s1_MJ_best = bt_s1_MJ_best
  )
rm(bt_s1_MA_best, bt_s1_MJ_best)
```
```{r, fig.width=14}
par(mfrow = c(1,2))
plot(bt_mod_lst$bt_s1_MA_best, all.terms = TRUE, select = 8, scale = 0, se = TRUE, bty = "n")
mtext("Adult Male Blacktip Strata 1", side = 3, cex = 2)


plot(bt_mod_lst$bt_s1_MJ_best, all.terms = TRUE, select = 7, scale = 0, se = TRUE, bty = "n")
mtext("Juvenile Male Blacktip Strata 1", side = 3, cex = 2)


```

### Figure 3 
```{r, include=FALSE}
### Figure Options

cex_pts <- 2
pch_pts <- "."

line_top <- 0

cex_txt <- 2.25

my_xlim = c(-100,-80)
my_ylim = c(22,33)

```

#### Layer 3 ($P(Occurrence) \times Abundance$)

Estimated CPUE multiplied by probability of occurance. Darker/green color reflects higher CPUE. White areas are areas outside sampling region where no predictions where made. 

```{r, fig.width=14}
layer <- 3

par(mfrow = c(1,2),
    oma = c(0,2,2,1),
    mar = c(3,3,0.5,0.5)#c(2,4,3,1)
)

## FA
plot(raster_blacktip_FA[[layer]])

sp::plot(gulf.shape, add= T,
         xlab = "", ylab = "",
         xlim = my_xlim, ylim = my_ylim,
         #xaxt = "n", yaxt = "n",
         col = "gray",
         bty="n")

points(startlat~startlon, 
       data = df_2_lst$blacktip_Female_Adult,
       xlim = my_xlim, ylim = my_ylim,
       pch = pch_pts,
       col = "black",
       #bg="black",
       cex = cex_pts)

## FJ
plot(raster_blacktip_FJ[[layer]], bty = "n")

sp::plot(gulf.shape, add= T,
         xlab = "", ylab = "",
         xlim = my_xlim, ylim = my_ylim,
         #xaxt = "n", yaxt = "n",
         col = "gray",
         bty="n")

points(startlat~startlon, 
       data = df_2_lst$blacktip_Female_Juvenile,
       xlim = my_xlim, ylim = my_ylim,
       pch = pch_pts,
       col = "black",
       #bg="black",
       cex = cex_pts)

mtext("Adult",
      side = 3,
      at=1/4,
      outer = TRUE,
      cex = cex_txt,
      line = line_top)

mtext("Juvenile",
      side = 3,
      at=3/4,
      outer = TRUE,
      cex = cex_txt,
      line = line_top)

mtext("Female",
      side = 2,
      at=2/4,
      outer = TRUE,
      cex = cex_txt)

mtext("(b)",
      side = 3, 
      at = 0.025,
      line = line_top,
      cex=cex_txt,
      outer = TRUE)

par(mfrow = c(1,2),
    oma = c(0,2,2,1),
    mar = c(3,3,0.5,0.5)#c(2,4,3,1)
    )

## MA
plot(raster_blacktip_MA[[layer]], bty = "n")

sp::plot(gulf.shape, add= T,
         xlab = "", ylab = "",
         xlim = my_xlim, ylim = my_ylim,
         #xaxt = "n", yaxt = "n",
         col = "gray",
         bty="n")

points(startlat~startlon, 
       data = df_2_lst$blacktip_Male_Adult,
       xlim = my_xlim, ylim = my_ylim,
       pch = pch_pts,
       col = "black",
       #bg="black",
       cex = cex_pts)

## MJ
plot(raster_blacktip_MJ[[layer]], bty = "n")

sp::plot(gulf.shape, add= T,
         xlab = "", ylab = "",
         xlim = my_xlim, ylim = my_ylim,
         #xaxt = "n", yaxt = "n",
         col = "gray",
         bty="n")

points(startlat~startlon, 
       data = df_2_lst$blacktip_Male_Juvenile,
       xlim = my_xlim, ylim = my_ylim,
       pch = pch_pts,
       col = "black",
       #bg="black",
       cex = cex_pts)

mtext("Male",
      side = 2,
      at=2/4,
      outer = TRUE,
      cex = cex_txt)
```


#### Layer 1 (Strata 1 $P(Occurrence)$)

Darker/green color reflects higher probability of occurance. White areas are areas outside sampling region where no predictions where made. 

```{r, fig.width=14}
layer <- 1

par(mfrow = c(1,2),
    oma = c(0,2,2,1),
    mar = c(3,3,0.5,0.5)#c(2,4,3,1)
)

## FA
plot(raster_blacktip_FA[[layer]])

sp::plot(gulf.shape, add= T,
         xlab = "", ylab = "",
         xlim = my_xlim, ylim = my_ylim,
         #xaxt = "n", yaxt = "n",
         col = "gray",
         bty="n")

points(startlat~startlon, 
       data = df_2_lst$blacktip_Female_Adult,
       xlim = my_xlim, ylim = my_ylim,
       pch = pch_pts,
       col = "black",
       #bg="black",
       cex = cex_pts)

## FJ
plot(raster_blacktip_FJ[[layer]], bty = "n")

sp::plot(gulf.shape, add= T,
         xlab = "", ylab = "",
         xlim = my_xlim, ylim = my_ylim,
         #xaxt = "n", yaxt = "n",
         col = "gray",
         bty="n")

points(startlat~startlon, 
       data = df_2_lst$blacktip_Female_Juvenile,
       xlim = my_xlim, ylim = my_ylim,
       pch = pch_pts,
       col = "black",
       #bg="black",
       cex = cex_pts)

mtext("Adult",
      side = 3,
      at=1/4,
      outer = TRUE,
      cex = cex_txt,
      line = line_top)

mtext("Juvenile",
      side = 3,
      at=3/4,
      outer = TRUE,
      cex = cex_txt,
      line = line_top)

mtext("Female",
      side = 2,
      at=2/4,
      outer = TRUE,
      cex = cex_txt)

mtext("(b)",
      side = 3, 
      at = 0.025,
      line = line_top,
      cex=cex_txt,
      outer = TRUE)

par(mfrow = c(1,2),
    oma = c(0,2,2,1),
    mar = c(3,3,0.5,0.5)#c(2,4,3,1)
    )

## MA
plot(raster_blacktip_MA[[layer]], bty = "n")

sp::plot(gulf.shape, add= T,
         xlab = "", ylab = "",
         xlim = my_xlim, ylim = my_ylim,
         #xaxt = "n", yaxt = "n",
         col = "gray",
         bty="n")

points(startlat~startlon, 
       data = df_2_lst$blacktip_Male_Adult,
       xlim = my_xlim, ylim = my_ylim,
       pch = pch_pts,
       col = "black",
       #bg="black",
       cex = cex_pts)

## MJ
plot(raster_blacktip_MJ[[layer]], bty = "n")

sp::plot(gulf.shape, add= T,
         xlab = "", ylab = "",
         xlim = my_xlim, ylim = my_ylim,
         #xaxt = "n", yaxt = "n",
         col = "gray",
         bty="n")

points(startlat~startlon, 
       data = df_2_lst$blacktip_Male_Juvenile,
       xlim = my_xlim, ylim = my_ylim,
       pch = pch_pts,
       col = "black",
       #bg="black",
       cex = cex_pts)

mtext("Male",
      side = 2,
      at=2/4,
      outer = TRUE,
      cex = cex_txt)
```

#### Layer 2 (Strata 2 Abundance)

Darker/green color reflects higher CPUE. White areas are areas outside sampling region where no predictions where made. 

```{r, fig.width=14}
layer <- 2

par(mfrow = c(1,2),
    oma = c(0,2,2,1),
    mar = c(3,3,0.5,0.5)#c(2,4,3,1)
)

## FA
plot(raster_blacktip_FA[[layer]])

sp::plot(gulf.shape, add= T,
         xlab = "", ylab = "",
         xlim = my_xlim, ylim = my_ylim,
         #xaxt = "n", yaxt = "n",
         col = "gray",
         bty="n")

points(startlat~startlon, 
       data = df_2_lst$blacktip_Female_Adult,
       xlim = my_xlim, ylim = my_ylim,
       pch = pch_pts,
       col = "black",
       #bg="black",
       cex = cex_pts)

## FJ
plot(raster_blacktip_FJ[[layer]], bty = "n")

sp::plot(gulf.shape, add= T,
         xlab = "", ylab = "",
         xlim = my_xlim, ylim = my_ylim,
         #xaxt = "n", yaxt = "n",
         col = "gray",
         bty="n")

points(startlat~startlon, 
       data = df_2_lst$blacktip_Female_Juvenile,
       xlim = my_xlim, ylim = my_ylim,
       pch = pch_pts,
       col = "black",
       #bg="black",
       cex = cex_pts)

mtext("Adult",
      side = 3,
      at=1/4,
      outer = TRUE,
      cex = cex_txt,
      line = line_top)

mtext("Juvenile",
      side = 3,
      at=3/4,
      outer = TRUE,
      cex = cex_txt,
      line = line_top)

mtext("Female",
      side = 2,
      at=2/4,
      outer = TRUE,
      cex = cex_txt)

mtext("(b)",
      side = 3, 
      at = 0.025,
      line = line_top,
      cex=cex_txt,
      outer = TRUE)

par(mfrow = c(1,2),
    oma = c(0,2,2,1),
    mar = c(3,3,0.5,0.5)#c(2,4,3,1)
    )

## MA
plot(raster_blacktip_MA[[layer]], bty = "n")

sp::plot(gulf.shape, add= T,
         xlab = "", ylab = "",
         xlim = my_xlim, ylim = my_ylim,
         #xaxt = "n", yaxt = "n",
         col = "gray",
         bty="n")

points(startlat~startlon, 
       data = df_2_lst$blacktip_Male_Adult,
       xlim = my_xlim, ylim = my_ylim,
       pch = pch_pts,
       col = "black",
       #bg="black",
       cex = cex_pts)

## MJ
plot(raster_blacktip_MJ[[layer]], bty = "n")

sp::plot(gulf.shape, add= T,
         xlab = "", ylab = "",
         xlim = my_xlim, ylim = my_ylim,
         #xaxt = "n", yaxt = "n",
         col = "gray",
         bty="n")

points(startlat~startlon, 
       data = df_2_lst$blacktip_Male_Juvenile,
       xlim = my_xlim, ylim = my_ylim,
       pch = pch_pts,
       col = "black",
       #bg="black",
       cex = cex_pts)

mtext("Male",
      side = 2,
      at=2/4,
      outer = TRUE,
      cex = cex_txt)
```













